<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab: 6 Lidar for Forest Management | FRST 538: Advanced Geomatics for Natural Resource Management</title>
  <meta name="description" content="Open Educational Resources for FRST 538 course at the University of British Columbia" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab: 6 Lidar for Forest Management | FRST 538: Advanced Geomatics for Natural Resource Management" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Open Educational Resources for FRST 538 course at the University of British Columbia" />
  <meta name="github-repo" content="github.com/ubc-geomatics-community-of-practice/FRST538-Advanced-Geomatics-for-Natural-Resource-Management/book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab: 6 Lidar for Forest Management | FRST 538: Advanced Geomatics for Natural Resource Management" />
  
  <meta name="twitter:description" content="Open Educational Resources for FRST 538 course at the University of British Columbia" />
  

<meta name="author" content="Paul D. Pickell" />


<meta name="date" content="2024-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spectral-signatures.html"/>
<link rel="next" href="time-series-image-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Open Geomatics Community of Practice</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-these-resources"><i class="fa fa-check"></i>How to use these resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-get-involved"><i class="fa fa-check"></i>How to get involved</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="network-analysis.html"><a href="network-analysis.html"><i class="fa fa-check"></i><b>1</b> Salmon Stream Network Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#lab-overview"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#learning-objectives"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#lab1-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-1-create-stream-segments"><i class="fa fa-check"></i>Task 1: Create stream segments</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-2-create-routes-and-apply-topology"><i class="fa fa-check"></i>Task 2: Create routes and apply topology</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-3-record-stream-attributes-with-linear-referencing"><i class="fa fa-check"></i>Task 3: Record stream attributes with linear referencing</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-4-trace-the-network"><i class="fa fa-check"></i>Task 4: Trace the network</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-5-overlay-and-query-the-network"><i class="fa fa-check"></i>Task 5: Overlay and query the network</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#final-report"><i class="fa fa-check"></i>Final Report</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lidar-terrain.html"><a href="lidar-terrain.html"><i class="fa fa-check"></i><b>2</b> LiDAR, terrain models and geovisualization</a>
<ul>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#lab-overview-1"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#learning-objectives-1"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#lab2-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#lab2-data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-1-load-and-explore-the-lidar-data"><i class="fa fa-check"></i>Task 1: Load and explore the LiDAR data</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-2-create-a-dtm-using-built-in-arcgis-functions"><i class="fa fa-check"></i>Task 2: Create a DTM using built-in ArcGIS functions</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-3-pre-process-data-for-interpolation"><i class="fa fa-check"></i>Task 3: Pre-process data for interpolation</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-4-raster-interpolation"><i class="fa fa-check"></i>Task 4: Raster interpolation</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-5-visually-interpret-differences"><i class="fa fa-check"></i>Task 5: Visually interpret differences</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-6-quantitatively-interpret-the-differences-and-calculate-statistics-for-each-zone"><i class="fa fa-check"></i>Task 6: Quantitatively interpret the differences and calculate statistics for each zone</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-7-create-a-map-document"><i class="fa fa-check"></i>Task 7: Create a map document</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-8-exploring-scenes"><i class="fa fa-check"></i>Task 8: Exploring Scenes</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#summary-1"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html"><i class="fa fa-check"></i><b>3</b> Suitability and Overlay Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#lab-overview-2"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#learning-objectives-2"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#lab3-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#data-1"><i class="fa fa-check"></i>Data</a>
<ul>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#data-organization"><i class="fa fa-check"></i>Data Organization</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#files-to-create"><i class="fa fa-check"></i>Files to Create</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-1-export-relevant-data-from-biologically-important-areas"><i class="fa fa-check"></i>Task 1: Export Relevant Data from Biologically Important Areas</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-2-identify-the-bia-of-the-humpback-whale-that-is-not-within-the-established-marine-sanctuary"><i class="fa fa-check"></i>Task 2: Identify the BIA of the Humpback Whale that is not within the established Marine Sanctuary</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-3-calculate-the-density-of-cetacean-sightings-using-the-bia-for-humpback-whales"><i class="fa fa-check"></i>Task 3: Calculate the Density of Cetacean Sightings using the BIA for Humpback Whales</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-4-extract-the-boats-from-ocean-uses-and-identity-the-vessels-within-the-bia-polygons"><i class="fa fa-check"></i>Task 4: Extract the Boats from Ocean Uses and Identity the Vessels within the BIA Polygons</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-5-calculate-suitability-and-identify-most-suitable-locations-for-the-marine-sanctuary"><i class="fa fa-check"></i>Task 5: Calculate Suitability and Identify Most Suitable Locations for the Marine Sanctuary</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#summary-2"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html"><i class="fa fa-check"></i><b>4</b> Analyzing Green Equity Using Geographically Weighted Regression</a>
<ul>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#lab-overview-3"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#learning-objectives-3"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#lab4-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#lab4-data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#task-1-visualize-census-data"><i class="fa fa-check"></i>Task 1: Visualize census data</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#task-2-calculate-ndvi-from-a-landsat-satellite-image"><i class="fa fa-check"></i>Task 2: Calculate NDVI from a Landsat satellite image</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#task-3-model-ndvi-using-census-characteristics"><i class="fa fa-check"></i>Task 3: Model NDVI using census characteristics</a>
<ul>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#ordinary-least-square-regression"><i class="fa fa-check"></i>Ordinary Least Square Regression</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#geographically-weighted-regression-1"><i class="fa fa-check"></i>Geographically Weighted Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#summary-3"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spectral-signatures.html"><a href="spectral-signatures.html"><i class="fa fa-check"></i><b>5</b> Getting to know Remote Sensing and spectral signatures</a>
<ul>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#lab-overview-4"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#learning-objectives-4"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#lab5-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#data-2"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#task-1-the-electromagnetic-spectrum"><i class="fa fa-check"></i>Task 1: The Electromagnetic Spectrum</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#task-2-landsat-5-bands-the-ems-arcgis-pro-software"><i class="fa fa-check"></i>Task 2: Landsat 5 Bands, the EMS, &amp; ArcGIS Pro Software</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#summary-4"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html"><i class="fa fa-check"></i><b>6</b> Lidar for Forest Management</a>
<ul>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#lab-overview-5"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#learning-objectives-5"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#lab6-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#data-3"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#lab-set-up"><i class="fa fa-check"></i>Lab Set up</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-1-load-rgb-imagery"><i class="fa fa-check"></i>Task 1: Load RGB Imagery</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-2-load-and-explore-the-lidar-data"><i class="fa fa-check"></i>Task 2: Load and Explore the LiDAR Data</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-3-read-multiple-las-files-into-lascatolog-object"><i class="fa fa-check"></i>Task 3: Read Multiple LAS Files into LAScatolog object</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-4-create-digital-elevation-model-dem"><i class="fa fa-check"></i>Task 4: Create Digital Elevation Model (DEM)</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-5-create-a-canopy-height-model"><i class="fa fa-check"></i>Task 5: Create a Canopy Height Model</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-6-extract-metrics-from-the-point-clouds"><i class="fa fa-check"></i>Task 6: Extract Metrics From the Point Clouds</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-7-individual-tree-detection"><i class="fa fa-check"></i>Task 7: Individual Tree Detection</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#summary-5"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html"><i class="fa fa-check"></i><b>7</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#lab-overview-6"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#learning-objectives-6"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#lab7-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#data-4"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#task-1-calcualting-ndvi-from-a-landsat-image"><i class="fa fa-check"></i>Task 1: Calcualting NDVI from a Landsat image</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#task-2-time-series-analysis"><i class="fa fa-check"></i>Task 2: Time Series Analysis</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#task-3-change-detection"><i class="fa fa-check"></i>Task 3: Change Detection</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#summary-6"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html"><i class="fa fa-check"></i><b>8</b> Machine Learning for Classification</a>
<ul>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#lab-overview-7"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#learning-objectives-7"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#lab8-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#data-5"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#task-1-creating-training-data"><i class="fa fa-check"></i>Task 1: Creating training data</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#task-2-training-a-random-forest-random-forest-algorithm"><i class="fa fa-check"></i>Task 2: Training a Random Forest (Random Forest Algorithm)</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#task-3-interpreting-classification-results"><i class="fa fa-check"></i>Task 3: Interpreting Classification Results</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#task-4-making-a-map"><i class="fa fa-check"></i>Task 4: Making a Map</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#summary-7"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">FRST 538: Advanced Geomatics for Natural Resource Management</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lidar-for-forest-management" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Lab: 6</span> Lidar for Forest Management<a href="lidar-for-forest-management.html#lidar-for-forest-management" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Written by
Spencer Dakin-Kuiper</p>
<div id="lab-overview-5" class="section level2 unnumbered hasAnchor">
<h2>Lab Overview<a href="lidar-for-forest-management.html#lab-overview-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The aim of this lab is to use LiDAR data from the Malcolm Knapp Research Forest (MKRF) explore a discrete return LiDAR dataset and become familiar with basic functions in the R package lidR and .las data sets. You will create digital terrain models (DTMs), digital surface models (DSM), canopy height models (CHMs) and visualize the point clouds in R. Additionally, we will explore individual tree detection and examine how LiDAR can be used to model forest attributes.</p>
<hr />
</div>
<div id="learning-objectives-5" class="section level2 unnumbered hasAnchor">
<h2>Learning Objectives<a href="lidar-for-forest-management.html#learning-objectives-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Create a DEM from LiDAR point data in both 2D and 3D</li>
<li>Calculate meaningful metrics from points clouds</li>
<li>Apply individual tree detection using point and CHM</li>
</ul>
<hr />
</div>
<div id="lab6-deliverables" class="section level2 unnumbered hasAnchor">
<h2>Deliverables<a href="lidar-for-forest-management.html#lab6-deliverables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><input type="checkbox" unchecked> Turn in the answers to the questions given in the lab on Canvas.</input></p>
<hr />
</div>
<div id="data-3" class="section level2 unnumbered hasAnchor">
<h2>Data<a href="lidar-for-forest-management.html#data-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will be working with LiDAR data collected over the Malcolm Knapp Research Forest (MKRF) in Maple Ridge, BC. There are three files associated with this lab:</p>
<ul>
<li>MKRF_Data_Specifications.pdf: A document describing the LiDAR data collection</li>
<li>LAS folder: The LiDAR data files in .LAS format. .LAS is the standard file type for LiDAR data</li>
<li>MKRF_Aerial_Photo.tif: An orthophoto of our study area, which was collected at the same time as the LiDAR data</li>
<li>MKRF_lidar: a single lidar file of the MKRF</li>
<li>Empty folders: you will save your outputs to these folders</li>
<li>Variety of CSVs used to create models</li>
<li>Lab6_Script.r: A script to process .las files using R and the lidR library.</li>
</ul>
<hr />
</div>
<div id="software" class="section level2 unnumbered hasAnchor">
<h2>Software<a href="lidar-for-forest-management.html#software" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>R/RStudio</li>
</ul>
<p>For this lab you will need to download R and RStudio. Rstudio is an open source integrated development environment (IDE, think fancy notepad) for the R programing language. It includes a console, syntax editor for code execution and will generally improve your R programing experience. If you need to install <a href="https://cran.rstudio.com/">R</a> and <a href="https://posit.co/download/rstudio-desktop/">R studio</a> click the respective links or ask your TA. If you already have them installed on your computer continue to the next section of the lab.</p>
<p><strong>Warning:</strong> This lab (and LiDAR processing in general) is computationally demanding. I have reduced the study area and used less rigorous algorithms to speed up processing time. Generally speaking a single line of code should not take longer than 5 minutes to run.</p>
<hr />
</div>
<div id="lab-set-up" class="section level2 unnumbered hasAnchor">
<h2>Lab Set up<a href="lidar-for-forest-management.html#lab-set-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this lab we will use two R packages: lidR and tidyverse</p>
<p>LidR contains the functions used to process the lidar data, while tidyverse is a generic set of function to help with data wrangling and manipulation.</p>
<p>To run lines of code within Rstudio you can use <strong>ctrl+enter</strong>. This will run either the highlighted text or the line of code your cursor is on.</p>
<p>To begin open RStudio and check if the packages are installed</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="lidar-for-forest-management.html#cb1-1" tabindex="-1"></a><span class="co">#Install and/or load packages </span></span>
<span id="cb1-2"><a href="lidar-for-forest-management.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="lidar-for-forest-management.html#cb1-3" tabindex="-1"></a><span class="co">#install.packages(&quot;lidR&quot;)# Run if not installed </span></span>
<span id="cb1-4"><a href="lidar-for-forest-management.html#cb1-4" tabindex="-1"></a><span class="co">#install.packages(&quot;tidyverse&quot;)# Run if not installed</span></span>
<span id="cb1-5"><a href="lidar-for-forest-management.html#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="lidar-for-forest-management.html#cb1-6" tabindex="-1"></a><span class="fu">library</span>(lidR)</span>
<span id="cb1-7"><a href="lidar-for-forest-management.html#cb1-7" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Set your working directory to the folder that contains your Lab 3 data using the setwd() function. Doing so will save you time during file uploading/exporting throughout the lab. If you forget your working directory after it is set, you can type getwd() into the console and R will print it for you.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="lidar-for-forest-management.html#cb2-1" tabindex="-1"></a><span class="co"># This is the only section of the lab you will need to fill out yourself. </span></span>
<span id="cb2-2"><a href="lidar-for-forest-management.html#cb2-2" tabindex="-1"></a><span class="co"># It should look something like this setwd(&quot;C:/Users/Spencer/FRST538/Lab6/Data&quot;) but using the path for your computer </span></span>
<span id="cb2-3"><a href="lidar-for-forest-management.html#cb2-3" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;C:/{file_path}&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="task-1-load-rgb-imagery" class="section level2 unnumbered hasAnchor">
<h2>Task 1: Load RGB Imagery<a href="lidar-for-forest-management.html#task-1-load-rgb-imagery" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When working with any airborne spatial data, it is useful to examine an RGB photo of the study site (MKRF_Aerial_Photo.tif). Take time to locate different land cover features (roads, lakes, streams, etc.) and to understand how vegetation structures are distributed. Is there wall-to-wall forest at the site? Are there any cut-blocks or major roads that could act as reference points during processing? Will the location of water bodies compromise random plot selection?</p>
<p>For this lab, these considerations have already been made. At the very least, you can use the RGB image of Malcolm Knapp Research Forest (MKRF) to gain perspective of our study area. We will use the brick function from the package raster, which was loaded automatically when we loaded lidR. This function creates a RasterBrick object from a multi-layer (or band) file (Figure <a href="lidar-for-forest-management.html#fig:03-rgb-malcolm-knapp">6.1</a>).</p>
<p>You can explore the details of any function that we use in this lab by typing a question mark <code>?</code> followed by the function name into the console: <code>?brick</code>. The information will appear in the Help pane of your RStudio interface.</p>
<p>Once the RasterBrick has been read into R, we will explore the objects structure using the <code>str()</code> function and plot the RGB image using the plot function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="lidar-for-forest-management.html#cb3-1" tabindex="-1"></a><span class="co">#Load RGB image and explore structure</span></span>
<span id="cb3-2"><a href="lidar-for-forest-management.html#cb3-2" tabindex="-1"></a>rgb_mkrf <span class="ot">&lt;-</span> <span class="fu">brick</span>(<span class="st">&#39;Aerial_Photo/MKRF_Aerial_Photo.tif&#39;</span>)</span>
<span id="cb3-3"><a href="lidar-for-forest-management.html#cb3-3" tabindex="-1"></a><span class="fu">str</span>(rgb_mkrf) </span>
<span id="cb3-4"><a href="lidar-for-forest-management.html#cb3-4" tabindex="-1"></a><span class="fu">plotRGB</span>(rgb_mkrf)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:03-rgb-malcolm-knapp"></span>
<img src="images/03-rgb-malcolm-knapp.png" alt="RGB image of the Malcolm Knapp Research Forest" width="100%" />
<p class="caption">
Figure 6.1: RGB image of the Malcolm Knapp Research Forest
</p>
</div>
<hr />
</div>
<div id="task-2-load-and-explore-the-lidar-data" class="section level2 unnumbered hasAnchor">
<h2>Task 2: Load and Explore the LiDAR Data<a href="lidar-for-forest-management.html#task-2-load-and-explore-the-lidar-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we need to load the file MKRF_lidar.las from your /Data folder. This file contains the lidar data you will need to complete this section of the lab. We will use the function <code>readLAS</code> to load the .las file. Once the file is loaded it should appear in your Environment as a ‘Large LAS’. It is best practice to use the function <code>lascheck</code> to conduct a deep inspection of a LAS object. This function will print a report for you to examine.</p>
<p>You can explore the structure of objects in your Environment using the <code>str()</code> base function in the Console. You can also explore the contents of a single column within the object by typing the objects name followed by a dollar sign and the column name: <code>object$column</code>.</p>
<p><em>HINT: If you wish to learn the details of any function associated with your loaded packages, you can type a question mark followed by the functions name: <code>?function_name</code></em></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="lidar-for-forest-management.html#cb4-1" tabindex="-1"></a><span class="co">#Load lidar data</span></span>
<span id="cb4-2"><a href="lidar-for-forest-management.html#cb4-2" tabindex="-1"></a>las_mkrf <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;./MKRF_lidar.las&quot;</span>) <span class="co">#read the specified .las file  </span></span>
<span id="cb4-3"><a href="lidar-for-forest-management.html#cb4-3" tabindex="-1"></a><span class="fu">las_check</span>(las_mkrf) <span class="co">#check the LAS object</span></span>
<span id="cb4-4"><a href="lidar-for-forest-management.html#cb4-4" tabindex="-1"></a><span class="fu">str</span>(las_mkrf) <span class="co">#compactly display the internal structure of las_mkrf</span></span>
<span id="cb4-5"><a href="lidar-for-forest-management.html#cb4-5" tabindex="-1"></a><span class="fu">print</span>(las_mkrf)</span></code></pre></div>
<div id="q1-examine-the-lascheck-output.-is-the-data-normalized-has-a-ground-classification-been-completed-already" class="section level5 unnumbered hasAnchor">
<h5>Q1: Examine the lascheck output. Is the data normalized? Has a ground classification been completed already?<a href="lidar-for-forest-management.html#q1-examine-the-lascheck-output.-is-the-data-normalized-has-a-ground-classification-been-completed-already" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="q2-examine-the-output-of-str.-how-many-first-returns-are-there-what-is-the-maximum-z-value" class="section level5 unnumbered hasAnchor">
<h5>Q2: Examine the output of str(). How many first returns are there? What is the maximum z value?<a href="lidar-for-forest-management.html#q2-examine-the-output-of-str.-how-many-first-returns-are-there-what-is-the-maximum-z-value" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="q3-examine-the-output-of-print.-what-is-the-density-of-this-data-is-that-high-low-or-somewhere-in-the-middle" class="section level5 unnumbered hasAnchor">
<h5>Q3: Examine the output of print(). What is the density of this data? Is that high, low, or somewhere in the middle?<a href="lidar-for-forest-management.html#q3-examine-the-output-of-print.-what-is-the-density-of-this-data-is-that-high-low-or-somewhere-in-the-middle" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Upon exploring the lascheck output you will notice that there are some duplicated points. This is not a problem for our analyses, but it is worth noting. For example, the statement: There were 6 degenerated ground points. Some X Y coordinates were repeated but with different Z coordinates means that multiple pulses measured the same location and returned different Z, or elevation, coordinates. This could be caused by overlapping flight paths or pre-processing errors, but lidR has the capacity to deal with these issue. Overall, our lidar data looks good. Before moving on let us remove the duplicated points.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="lidar-for-forest-management.html#cb5-1" tabindex="-1"></a><span class="co">#remove duplicated Z (eleavation) points</span></span>
<span id="cb5-2"><a href="lidar-for-forest-management.html#cb5-2" tabindex="-1"></a>las_mkrf <span class="ot">&lt;-</span> <span class="fu">filter_duplicates</span>(las_mkrf) <span class="co">#remove the duplicated points</span></span>
<span id="cb5-3"><a href="lidar-for-forest-management.html#cb5-3" tabindex="-1"></a><span class="co">#confirm duplicates removed</span></span>
<span id="cb5-4"><a href="lidar-for-forest-management.html#cb5-4" tabindex="-1"></a><span class="fu">las_check</span>(las_mkrf) <span class="co">#run lascheck a second time to ensure duplicates removed</span></span></code></pre></div>
<p>Now that we have a general understanding of our lidar data, it is time to start visualizing! We will explore 2D and 3D plots of our data to gain an even deeper understanding of our study site before undergoing some basic manipulation.</p>
<p>First, we will visualize the density of lidar points across our site. You will notice that some areas have a higher density than others. This is likely due to the flight path of the aircraft that collected our data and probably causes some of the duplicated points that were highlighted by <code>lascheck</code>. Next, we will plot las_mkrf in 3D using the plot function. In lidR, this function can produce plots in 2D or 3D, depending on structure of the input object. LASobjects are plotted in 3D, while Raster objects are 2D.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="lidar-for-forest-management.html#cb6-1" tabindex="-1"></a><span class="co">#Visualize point density </span></span>
<span id="cb6-2"><a href="lidar-for-forest-management.html#cb6-2" tabindex="-1"></a>density_mkrf <span class="ot">&lt;-</span> <span class="fu">grid_density</span>(las_mkrf, <span class="at">res =</span> <span class="dv">2</span>) <span class="co">#create a map of the point density</span></span>
<span id="cb6-3"><a href="lidar-for-forest-management.html#cb6-3" tabindex="-1"></a><span class="fu">plot</span>(density_mkrf) </span>
<span id="cb6-4"><a href="lidar-for-forest-management.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="lidar-for-forest-management.html#cb6-5" tabindex="-1"></a><span class="co">#Visualize las_mkrf in 3D </span></span>
<span id="cb6-6"><a href="lidar-for-forest-management.html#cb6-6" tabindex="-1"></a><span class="fu">plot</span>(las_mkrf)</span></code></pre></div>
<p>Wonderful! We can now explore lidar data in 3D by clicking and scrolling through the RGL plot. Due to the size of the file this exploration may be relatively slow (Figure <a href="#fig:03-rgl-plot"><strong>??</strong></a>).</p>
<p><img src="images/03-rgl-plot.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="task-3-read-multiple-las-files-into-lascatolog-object" class="section level2 unnumbered hasAnchor">
<h2>Task 3: Read Multiple LAS Files into LAScatolog object<a href="lidar-for-forest-management.html#task-3-read-multiple-las-files-into-lascatolog-object" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once you have a basic understanding of the study area, it is time to load your lidar data. The file type used in this course is LAS, which is an industry standard format for storing lidar data. In the future, you may also work with other file formats, such as LAZ. You can explore the differences between these formats <a href="https://rapidlasso.de/five-myths-about-las-laz-and-optimized-las/">online</a>.</p>
<p>In the last task, we loaded a single LAS object and plotted it. For the remainder of this lab, we will load 20 tiles collected over MKRF into a LAScatalog object. This will enable us to manage and process our entire data set as one object, rather than 20 separate files. We can use lascheck to perform a deep inspection of the LASCatalog object or use <code>summary()</code> for a more succinct report.</p>
<p>We can also plot a LAScatalog object to observe how our tiles are arranged. Since the LASCAtalog object is a SpatialPolygonsDataFrame, it is possible to use the <code>spplot</code> function to visualize certain characteristics of our data. For example, the line <code>spplot(cat_mkrf, "Min.Z")</code> will plot catalog and color each tile based on it’s lowest elevation (Z) value (Figure <a href="#fig:03-rgl-plot"><strong>??</strong></a>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="lidar-for-forest-management.html#cb7-1" tabindex="-1"></a><span class="co">#Create LAScatalog object from MKRF las tiles</span></span>
<span id="cb7-2"><a href="lidar-for-forest-management.html#cb7-2" tabindex="-1"></a>cat_mkrf <span class="ot">&lt;-</span> <span class="fu">readLAScatalog</span>(<span class="st">&quot;LAS&quot;</span>)</span>
<span id="cb7-3"><a href="lidar-for-forest-management.html#cb7-3" tabindex="-1"></a><span class="fu">las_check</span>(cat_mkrf)</span>
<span id="cb7-4"><a href="lidar-for-forest-management.html#cb7-4" tabindex="-1"></a><span class="fu">summary</span>(cat_mkrf)</span>
<span id="cb7-5"><a href="lidar-for-forest-management.html#cb7-5" tabindex="-1"></a><span class="fu">plot</span>(cat_mkrf)</span></code></pre></div>
<p>Notice that there are overlapping tiles. This indicates that there may be duplicate points within our data. We can confirm this by applying the <code>lascheck</code> function to a single tile.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="lidar-for-forest-management.html#cb8-1" tabindex="-1"></a><span class="co">#Examine single .las tile to determine duplication</span></span>
<span id="cb8-2"><a href="lidar-for-forest-management.html#cb8-2" tabindex="-1"></a>tile_1_mkrf <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;LAS/MKRF_Tile1.las&quot;</span>)</span>
<span id="cb8-3"><a href="lidar-for-forest-management.html#cb8-3" tabindex="-1"></a><span class="fu">lascheck</span>(tile_1_mkrf)</span></code></pre></div>
<p>It appears that there are 421 duplicate points. These may impact both the accuracy of our analysis and the processing speed. Let us remove them using the <code>filter_duplicates</code> function and store the filtered tiles in a new folder named ‘Filtered’ (this folder has already been created for you). Once complete, confirm that the duplicates were removed.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="lidar-for-forest-management.html#cb9-1" tabindex="-1"></a><span class="co">#Set the output directory for the filtered .las data</span></span>
<span id="cb9-2"><a href="lidar-for-forest-management.html#cb9-2" tabindex="-1"></a>work_dir <span class="ot">=</span> <span class="fu">getwd</span>() <span class="co">#create a filepath to your working directory</span></span>
<span id="cb9-3"><a href="lidar-for-forest-management.html#cb9-3" tabindex="-1"></a><span class="fu">opt_output_files</span>(cat_mkrf) <span class="ot">&lt;-</span> <span class="fu">paste</span>(work_dir, <span class="st">&quot;/Filtered/filtered_mkrf_{ID}&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)<span class="co">#location to store duplicate points</span></span>
<span id="cb9-4"><a href="lidar-for-forest-management.html#cb9-4" tabindex="-1"></a>cat_mkrf <span class="ot">&lt;-</span> <span class="fu">filter_duplicates</span>(cat_mkrf) <span class="co">#remove duplicate points and speed up processing</span></span>
<span id="cb9-5"><a href="lidar-for-forest-management.html#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="lidar-for-forest-management.html#cb9-6" tabindex="-1"></a><span class="co">#confirm that duplicates were removed for Tile 1</span></span>
<span id="cb9-7"><a href="lidar-for-forest-management.html#cb9-7" tabindex="-1"></a>filtered_t1_mkrf <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;Filtered/filtered_mkrf_1.las&quot;</span>) <span class="co">#load from stored file</span></span>
<span id="cb9-8"><a href="lidar-for-forest-management.html#cb9-8" tabindex="-1"></a><span class="fu">lascheck</span>(filtered_t1_mkrf)</span></code></pre></div>
<p>Success! We can now proceed with our analysis. Let us read all filtered LAS data into a catalog and perform the usual checks.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="lidar-for-forest-management.html#cb10-1" tabindex="-1"></a><span class="co">#read filtered .las into LAScatalog</span></span>
<span id="cb10-2"><a href="lidar-for-forest-management.html#cb10-2" tabindex="-1"></a>filtered_cat_mkrf <span class="ot">&lt;-</span> <span class="fu">readLAScatalog</span>(<span class="st">&quot;Filtered&quot;</span>)</span>
<span id="cb10-3"><a href="lidar-for-forest-management.html#cb10-3" tabindex="-1"></a><span class="fu">summary</span>(filtered_cat_mkrf)</span>
<span id="cb10-4"><a href="lidar-for-forest-management.html#cb10-4" tabindex="-1"></a><span class="fu">plot</span>(filtered_cat_mkrf)</span>
<span id="cb10-5"><a href="lidar-for-forest-management.html#cb10-5" tabindex="-1"></a><span class="fu">spplot</span>(filtered_cat_mkrf, <span class="st">&quot;Min.Z&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="task-4-create-digital-elevation-model-dem" class="section level2 unnumbered hasAnchor">
<h2>Task 4: Create Digital Elevation Model (DEM)<a href="lidar-for-forest-management.html#task-4-create-digital-elevation-model-dem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have practiced some of the basic visualization, reading, and cleaning techniques on raw lidar data it is time to move onto processing. The first thing we will do is create a digital elevation model (DEM). A DEM represents the Earth’s surface without vegetation, which we will refer to as “ground”. Although this seems like an intuitive statement, there is the potential for logs, rocks and other non-soil objects to be included as ground points. These won’t cause issues for our analyses, but it is important to use precise language when working with common words like “ground”. Never assume that your definition of something is a global truth. It is also important to consider that a DEM can also be referred to as a digital terrain model (DTM). Take time to understand that both terms refer to a surface model of only ground points. Instructors/colleagues could use DEM and DTM interchangeably.</p>
<p>We will create and visualize a DEM in both 2D and 3D. The 3D version will be created by filtering out all points that are not classified as ground (Classification: 2). For the 2D DEM, we will use the <code>grid_terrain</code> function on our LidR catalogue. This function enables the user to select the output resolution and the algorithm that computes spatial interpolation. It is recommended that you take time to understand the three algorithms in highlighted in the <code>grid_terrain</code> ‘Help’ file.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="lidar-for-forest-management.html#cb11-1" tabindex="-1"></a><span class="co">#DEM</span></span>
<span id="cb11-2"><a href="lidar-for-forest-management.html#cb11-2" tabindex="-1"></a><span class="co">#3D</span></span>
<span id="cb11-3"><a href="lidar-for-forest-management.html#cb11-3" tabindex="-1"></a>dem_3D_mkrf <span class="ot">&lt;-</span> <span class="fu">filter_poi</span>(las_mkrf, Classification <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb11-4"><a href="lidar-for-forest-management.html#cb11-4" tabindex="-1"></a><span class="fu">plot</span>(dem_3D_mkrf) <span class="co">#zoom in to notice no trees</span></span>
<span id="cb11-5"><a href="lidar-for-forest-management.html#cb11-5" tabindex="-1"></a><span class="fu">plot</span>(las_mkrf) <span class="co"># compare to dem_3dmkrf</span></span>
<span id="cb11-6"><a href="lidar-for-forest-management.html#cb11-6" tabindex="-1"></a><span class="co">#demCatalog</span></span>
<span id="cb11-7"><a href="lidar-for-forest-management.html#cb11-7" tabindex="-1"></a>dem_allLAS_mkrf <span class="ot">&lt;-</span> <span class="fu">grid_terrain</span>(filtered_cat_mkrf, <span class="dv">2</span>, <span class="fu">tin</span>()) <span class="co">#why use this method? check warnings: why might points get degenerated DON&#39;T PANIC AT &#39;WARNING&#39;</span></span>
<span id="cb11-8"><a href="lidar-for-forest-management.html#cb11-8" tabindex="-1"></a><span class="co"># create Colour ramp for visualization </span></span>
<span id="cb11-9"><a href="lidar-for-forest-management.html#cb11-9" tabindex="-1"></a>col_1 <span class="ot">&lt;-</span> <span class="fu">height.colors</span>(<span class="dv">50</span>)</span>
<span id="cb11-10"><a href="lidar-for-forest-management.html#cb11-10" tabindex="-1"></a><span class="fu">plot</span>(dem_allLAS_mkrf, <span class="at">col =</span> col_1)</span></code></pre></div>
<div id="screenshot-1-submit-the-output-of-this-plot-as-a-screenshot." class="section level5 unnumbered hasAnchor">
<h5>Screenshot 1: Submit the output of this plot() as a screenshot.<a href="lidar-for-forest-management.html#screenshot-1-submit-the-output-of-this-plot-as-a-screenshot." class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>With the DEM complete we can normalize our LAScatalog. Each tile will be normalized separately, which means there will be one normalized output tile for each input. lidR requires an output directory to be specified. A folder named ‘Normalized’ has already been created for you. Once the output file directory is set we will use <code>lasnormalize</code> to conduct the normalization of all our MKRF lidar tiles.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="lidar-for-forest-management.html#cb12-1" tabindex="-1"></a><span class="co">#Normalize catalog with DEM</span></span>
<span id="cb12-2"><a href="lidar-for-forest-management.html#cb12-2" tabindex="-1"></a>norm_tiles_mkrf <span class="ot">&lt;-</span> <span class="fu">lasnormalize</span>(filtered_cat_mkrf, dem_allLAS_mkrf)</span>
<span id="cb12-3"><a href="lidar-for-forest-management.html#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="lidar-for-forest-management.html#cb12-4" tabindex="-1"></a><span class="co">#define LAScatalog engine options</span></span>
<span id="cb12-5"><a href="lidar-for-forest-management.html#cb12-5" tabindex="-1"></a><span class="fu">opt_output_files</span>(filtered_cat_mkrf) <span class="ot">&lt;-</span> <span class="fu">paste</span>(work_dir, <span class="st">&quot;/Normalized/norm_mkrf_{ID}&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb12-6"><a href="lidar-for-forest-management.html#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="lidar-for-forest-management.html#cb12-7" tabindex="-1"></a><span class="co">#normalize all tiles in cat_mkrf with the DEM </span></span>
<span id="cb12-8"><a href="lidar-for-forest-management.html#cb12-8" tabindex="-1"></a>norm_tiles_mkrf <span class="ot">&lt;-</span> <span class="fu">normalize_height</span>(filtered_cat_mkrf, dem_allLAS_mkrf) <span class="co">#check your folder when complete </span></span>
<span id="cb12-9"><a href="lidar-for-forest-management.html#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="lidar-for-forest-management.html#cb12-10" tabindex="-1"></a><span class="co">#check to see if the normalization worked</span></span>
<span id="cb12-11"><a href="lidar-for-forest-management.html#cb12-11" tabindex="-1"></a>norm_mkrf_1 <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;Normalized/norm_mkrf_1.las&quot;</span>)</span>
<span id="cb12-12"><a href="lidar-for-forest-management.html#cb12-12" tabindex="-1"></a><span class="fu">plot</span>(norm_mkrf_1) </span></code></pre></div>
<p>Explore the 3D rgl plot that is produced by the last line in the above code block (Figure <a href="lidar-for-forest-management.html#fig:03-normalized-tile-mkrf">6.2</a>). Does anything look abnormal to you?</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:03-normalized-tile-mkrf"></span>
<img src="images/03-normalized-tile-mkrf.png" alt="Normalized tile 1 from MKRF." width="100%" />
<p class="caption">
Figure 6.2: Normalized tile 1 from MKRF.
</p>
</div>
</div>
<div id="q4-there-appears-to-be-an-outlying-data-point-located-high-above-the-others.-explain-why-this-would-cause-issues-during-our-processing-and-an-example-of-what-would-cause-this-outlier." class="section level5 unnumbered hasAnchor">
<h5>Q4: There appears to be an outlying data point located high above the others. Explain why this would cause issues during our processing and an example of what would cause this outlier.<a href="lidar-for-forest-management.html#q4-there-appears-to-be-an-outlying-data-point-located-high-above-the-others.-explain-why-this-would-cause-issues-during-our-processing-and-an-example-of-what-would-cause-this-outlier." class="anchor-section" aria-label="Anchor link to header"></a></h5>
<hr />
</div>
</div>
<div id="task-5-create-a-canopy-height-model" class="section level2 unnumbered hasAnchor">
<h2>Task 5: Create a Canopy Height Model<a href="lidar-for-forest-management.html#task-5-create-a-canopy-height-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can explore the effect of this outlier by generating a canopy height model (CHM) with the grid_canopy function. Mathematically, a CHM is simply the DEM (or DTM, remember these terms are interchangeable!) subtracted from the DSM. This subtraction can be called ‘normalization’, differing from the normalization conducted using <code>lasnormalize</code> in the sense that the output is 2D. The CHM is an important surface model as it allows us to analyze objects above a common ground value (0m). This 2D output should have a maximum height around that of the highest tree on site (~ 60m).</p>
<p>The <code>grid_canopy</code> function is used to generate CHMs, which has three user defined arguments. The first, <code>las</code> refers to the input data (LAS or LAScatalog). The second, <code>res</code> refers to the spatial resolution. The third argument, <code>algorithm</code> specifies the algorithm that will be used to compute the digital surface model. There are three algorithms compatible with grid_canopy:</p>
<p><code>p2r</code> is a point-to-raster method. It returns the maximum height value of the point cloud for each area, which is defined by the spatial resolution. This is a relatively fast algorithm, but can generate ‘pits’, or areas of ‘NoData’ in the CHM where there are no returns present. You can add a subcircle argument within the p2r algorithm to try and remove pits. This method replaces each lidar point with a disk of a specified size and increases return coverage. If you use this method, be aware that issues related to computation speed may arise.</p>
<p><code>dsmtin</code> is a triangulation-based method that creates a triangular irregular network (TIN) by interpolating only the first returns before generating a 2D grid. This method eliminates empty pixels, but can still generate pits within crowns as some first returns inevitably reach the ground.</p>
<p><code>pitfree</code> is a triangulation-based method that conducts multiple triangulations at various heights. Developed by Khosravipour et al. (2014), the pitfree algorithm ensure there are no empty cells or deep pits. Shallow pits may remain, but can be removed by adding a subcircle argument. Although the most sophisticated, this algorithm is computationally intense.</p>
<p>Since we know that our lidar data has 3.1 returns · m<sup>-2</sup>, we can assume that a spatial resolution of 2 m will ensure that every cell in our raster contains at least one return. This, along with the advantage of quick processing (~1 min for entire site), allows us to use the stock <code>p2r</code> algorithm without worrying about pits. Feel free to use <code>dsmtin()</code> (~5 min) or <code>pitfree()</code> (~10 min) for the following steps, just ensure you annotate your code accordingly.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="lidar-for-forest-management.html#cb13-1" tabindex="-1"></a><span class="co">#Create CHM for normalized Tile 1</span></span>
<span id="cb13-2"><a href="lidar-for-forest-management.html#cb13-2" tabindex="-1"></a>chm_mkrf_1 <span class="ot">&lt;-</span> <span class="fu">grid_canopy</span>(norm_mkrf_1, <span class="dv">2</span>, <span class="fu">p2r</span>()) <span class="co">#las, resolution, algorithm</span></span>
<span id="cb13-3"><a href="lidar-for-forest-management.html#cb13-3" tabindex="-1"></a><span class="fu">plot</span>(chm_mkrf_1, <span class="at">col =</span> col_1) <span class="co">#plot in 2D</span></span>
<span id="cb13-4"><a href="lidar-for-forest-management.html#cb13-4" tabindex="-1"></a><span class="fu">plot_dtm3d</span>(chm_mkrf_1) <span class="co">#plot in 3D</span></span></code></pre></div>
<p>It is clear that the normalization was not perfect as the maximum height of the CHM is well above our expected maximum height. This issue is caused by the outlier visible in the 3D plot. It also looks like there are some points below 0m. To remedy these issues, we can use the LAScatalog options engine to filter out data points below 0 m and above 65 m.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="lidar-for-forest-management.html#cb14-1" tabindex="-1"></a>LAScatalog options engine to filter out data points below <span class="dv">0</span>m and above <span class="dv">65</span>m.</span>
<span id="cb14-2"><a href="lidar-for-forest-management.html#cb14-2" tabindex="-1"></a><span class="co">#read normalized las into catalog to continue processing</span></span>
<span id="cb14-3"><a href="lidar-for-forest-management.html#cb14-3" tabindex="-1"></a>norm_cat_mkrf <span class="ot">&lt;-</span> <span class="fu">readLAScatalog</span>(<span class="st">&quot;Normalized&quot;</span>)</span>
<span id="cb14-4"><a href="lidar-for-forest-management.html#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="lidar-for-forest-management.html#cb14-5" tabindex="-1"></a><span class="co">#add LAScatalog enginge option to filter undersired data points</span></span>
<span id="cb14-6"><a href="lidar-for-forest-management.html#cb14-6" tabindex="-1"></a><span class="fu">opt_filter</span>(norm_cat_mkrf) <span class="ot">&lt;-</span> <span class="st">&#39;-drop_z_below 0 -drop_z_above 65&#39;</span></span>
<span id="cb14-7"><a href="lidar-for-forest-management.html#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="lidar-for-forest-management.html#cb14-8" tabindex="-1"></a><span class="co">#ensure the entire study area was processed</span></span>
<span id="cb14-9"><a href="lidar-for-forest-management.html#cb14-9" tabindex="-1"></a><span class="fu">plot</span>(norm_cat_mkrf)</span>
<span id="cb14-10"><a href="lidar-for-forest-management.html#cb14-10" tabindex="-1"></a><span class="fu">summary</span>(norm_cat_mkrf)</span></code></pre></div>
<p>It seems like all of the normalized LAS files were loaded correctly, but we still need to confirm that the outliers were removed by the filter we applied. To do this we will create another CHM. Instead of making the CHM for Tile 1, we will create a CHM for the entire site.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="lidar-for-forest-management.html#cb15-1" tabindex="-1"></a><span class="co">#Create CHM for all normalized MKRF Tiles</span></span>
<span id="cb15-2"><a href="lidar-for-forest-management.html#cb15-2" tabindex="-1"></a>chm_mkrf <span class="ot">&lt;-</span> <span class="fu">grid_canopy</span>(norm_cat_mkrf, <span class="dv">2</span>, <span class="fu">p2r</span>()) </span>
<span id="cb15-3"><a href="lidar-for-forest-management.html#cb15-3" tabindex="-1"></a><span class="fu">plot</span>(chm_mkrf, <span class="at">col =</span> col_1) <span class="co">#plot in 2D</span></span>
<span id="cb15-4"><a href="lidar-for-forest-management.html#cb15-4" tabindex="-1"></a><span class="co">#plot_dtm3d(chm_mkrf) #plot in 3D *DON&#39;T RUN IF COMPUTER IS SLOW*</span></span></code></pre></div>
<p>Excellent! The heights in our CHM are as expected. If you are interested in exploring how the CHM relates to the RGB image of the area, please compare the two now.</p>
<div id="screenshot-2-include-an-image-of-your-chm." class="section level5 unnumbered hasAnchor">
<h5>Screenshot 2: Include an image of your CHM.<a href="lidar-for-forest-management.html#screenshot-2-include-an-image-of-your-chm." class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="q5.-what-do-you-think-the-large-empty-locations-in-the-chm-represent" class="section level5 unnumbered hasAnchor">
<h5>Q5. What do you think the large empty locations in the CHM represent?<a href="lidar-for-forest-management.html#q5.-what-do-you-think-the-large-empty-locations-in-the-chm-represent" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<hr />
</div>
</div>
<div id="task-6-extract-metrics-from-the-point-clouds" class="section level2 unnumbered hasAnchor">
<h2>Task 6: Extract Metrics From the Point Clouds<a href="lidar-for-forest-management.html#task-6-extract-metrics-from-the-point-clouds" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have confirmed that our filter works at the catalog level, it is time to extract some plots. First, let us extract a single plot. We use the lasclip function to do this. Specifically, we will use lasclipCircle to extract circular plots from our lidar data. Check out the details of this function in the lidR documentation provided at the start of the lab. We will extract a plot with the following characteristics:</p>
<p><strong>X = 530118.9</strong></p>
<p><strong>Y = 5462882.0</strong></p>
<p><strong>Radius = 25</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="lidar-for-forest-management.html#cb16-1" tabindex="-1"></a><span class="co">#Extract single plot</span></span>
<span id="cb16-2"><a href="lidar-for-forest-management.html#cb16-2" tabindex="-1"></a>single_plot_mkrf <span class="ot">&lt;-</span> <span class="fu">clip_circle</span>(norm_cat_mkrf, <span class="fl">530118.9</span>, <span class="fl">5462882.0</span>, <span class="dv">25</span>)</span>
<span id="cb16-3"><a href="lidar-for-forest-management.html#cb16-3" tabindex="-1"></a><span class="fu">plot</span>(single_plot_mkrf) </span></code></pre></div>
<p>Now we will extract multiple plots using a for loop. The location of each plots is provided in the ‘Plot_Table.csv’ within the ‘/Plots’ folder of your lab data. Plot radii should be 30 m. The for loop is annotated for you so you can understand what each line of code is doing.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="lidar-for-forest-management.html#cb17-1" tabindex="-1"></a>plot_table <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Plots/Plot_Table.csv&quot;</span>)</span>
<span id="cb17-2"><a href="lidar-for-forest-management.html#cb17-2" tabindex="-1"></a>radius <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co">#the radius for lasclipCircle()</span></span>
<span id="cb17-3"><a href="lidar-for-forest-management.html#cb17-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plot_table)){ <span class="co">#run the loop until i = the number of rows in &#39;plot_table&#39; (20)</span></span>
<span id="cb17-4"><a href="lidar-for-forest-management.html#cb17-4" tabindex="-1"></a>  plot_cent <span class="ot">&lt;-</span> <span class="fu">c</span>(plot_table<span class="sc">$</span>X[i], plot_table<span class="sc">$</span>Y[i]) <span class="co">#extract plot center</span></span>
<span id="cb17-5"><a href="lidar-for-forest-management.html#cb17-5" tabindex="-1"></a>  plot_las <span class="ot">&lt;-</span> <span class="fu">clip_circle</span>(norm_cat_mkrf, plot_cent[<span class="dv">1</span>], plot_cent[<span class="dv">2</span>], radius) <span class="co">#clip plot from norm_cat_las</span></span>
<span id="cb17-6"><a href="lidar-for-forest-management.html#cb17-6" tabindex="-1"></a>  output_file <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Plots/MKRF_Plot_&quot;</span>, i, <span class="st">&quot;.las&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>) <span class="co">#output directory as string</span></span>
<span id="cb17-7"><a href="lidar-for-forest-management.html#cb17-7" tabindex="-1"></a>  <span class="fu">writeLAS</span>(<span class="fu">assign</span>(<span class="fu">paste</span>(<span class="st">&quot;MKRF_Plot_&quot;</span>, i, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), plot_las), output_file) <span class="co">#write&#39;MKRF_Plot_i&#39; to output dir.</span></span>
<span id="cb17-8"><a href="lidar-for-forest-management.html#cb17-8" tabindex="-1"></a>}</span></code></pre></div>
<p>At this point, you can explore individual plots in 3D, which should be loaded in your Environment, using <code>plot()</code>.</p>
<p>Now that we have extracted our plots it is time to compute some standard cloud metrics. To do this, we will need to analyze each plot individually. We also need to make sure that we are only including the first returns. This will ensure our metrics do not include points that have been scattered throughout the canopy. Let’s also remove all points below 2 m, as objects below this height could be non-tree (shrubs, fallen logs, etc.). We do not need to worry about outliers as we removed them during the normalization process. Explore the Console output of the line plot_1_metrics for a brief overview of the metrics being created.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="lidar-for-forest-management.html#cb18-1" tabindex="-1"></a><span class="co">#Calculate cloud metrics for all plots</span></span>
<span id="cb18-2"><a href="lidar-for-forest-management.html#cb18-2" tabindex="-1"></a><span class="co">#there are special considerations: only first returns between 2m and 65m</span></span>
<span id="cb18-3"><a href="lidar-for-forest-management.html#cb18-3" tabindex="-1"></a><span class="co">#create empty dataframe</span></span>
<span id="cb18-4"><a href="lidar-for-forest-management.html#cb18-4" tabindex="-1"></a>mkrf_plot_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>() </span>
<span id="cb18-5"><a href="lidar-for-forest-management.html#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="lidar-for-forest-management.html#cb18-6" tabindex="-1"></a><span class="co">#For loop to calculate cloud metrics for all plots and add them to &#39;mkrf_cloud_metrics&#39;</span></span>
<span id="cb18-7"><a href="lidar-for-forest-management.html#cb18-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plot_table)){ <span class="co">#for loop == number of rows in plot_table (20)</span></span>
<span id="cb18-8"><a href="lidar-for-forest-management.html#cb18-8" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="fu">paste</span>(<span class="st">&quot;Plots/MKRF_Plot_&quot;</span>, i, <span class="st">&quot;.las&quot;</span>, <span class="at">sep=</span> <span class="st">&quot;&quot;</span>), <span class="at">filter =</span> <span class="st">&quot;-keep_first -drop_z_below 2&quot;</span>)</span>
<span id="cb18-9"><a href="lidar-for-forest-management.html#cb18-9" tabindex="-1"></a>  metrics <span class="ot">&lt;-</span> <span class="fu">cloud_metrics</span>(plot, .stdmetrics) <span class="co">#compute standard metrics</span></span>
<span id="cb18-10"><a href="lidar-for-forest-management.html#cb18-10" tabindex="-1"></a>  mkrf_plot_metrics <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mkrf_plot_metrics, metrics) <span class="co">#add the new &#39;metrics&#39; to &#39;mkrf_cloud_metrics&#39;</span></span>
<span id="cb18-11"><a href="lidar-for-forest-management.html#cb18-11" tabindex="-1"></a>}</span></code></pre></div>
<p>Take a few minutes to scroll through mkrf_cloud_metrics. You can export this dataframe to a .csv if you wish. There are many metrics calculate by this function and you can explore them in detail by typing <code>?cloud_metrics</code> into your console and navigating through the interactive Help page. Below are some basic details relating to cloud_metric notation that you can find by clicking on <code>stdmetrics</code> in the aforementioned Help page</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="lidar-for-forest-management.html#cb19-1" tabindex="-1"></a>Details</span>
<span id="cb19-2"><a href="lidar-for-forest-management.html#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="lidar-for-forest-management.html#cb19-3" tabindex="-1"></a>The <span class="cf">function</span> names, their parameters and the output names of the metrics rely on a nomenclature chosen <span class="cf">for</span> brevity<span class="sc">:</span></span>
<span id="cb19-4"><a href="lidar-for-forest-management.html#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="lidar-for-forest-management.html#cb19-5" tabindex="-1"></a>z<span class="sc">:</span> refers to the elevation</span>
<span id="cb19-6"><a href="lidar-for-forest-management.html#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="lidar-for-forest-management.html#cb19-7" tabindex="-1"></a>i<span class="sc">:</span> refers to the intensity</span>
<span id="cb19-8"><a href="lidar-for-forest-management.html#cb19-8" tabindex="-1"></a></span>
<span id="cb19-9"><a href="lidar-for-forest-management.html#cb19-9" tabindex="-1"></a>rn<span class="sc">:</span> refers to the return number</span>
<span id="cb19-10"><a href="lidar-for-forest-management.html#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="lidar-for-forest-management.html#cb19-11" tabindex="-1"></a>q<span class="sc">:</span> refers to quantile</span>
<span id="cb19-12"><a href="lidar-for-forest-management.html#cb19-12" tabindex="-1"></a></span>
<span id="cb19-13"><a href="lidar-for-forest-management.html#cb19-13" tabindex="-1"></a>a<span class="sc">:</span> refers to the ScanAngleRank or ScanAngle</span>
<span id="cb19-14"><a href="lidar-for-forest-management.html#cb19-14" tabindex="-1"></a></span>
<span id="cb19-15"><a href="lidar-for-forest-management.html#cb19-15" tabindex="-1"></a>n<span class="sc">:</span> refers to a <span class="fu">number</span> (a count)</span>
<span id="cb19-16"><a href="lidar-for-forest-management.html#cb19-16" tabindex="-1"></a></span>
<span id="cb19-17"><a href="lidar-for-forest-management.html#cb19-17" tabindex="-1"></a>p<span class="sc">:</span> refers to a percentage</span></code></pre></div>
<p>Let us take a closer look at the metrics for plots 1 and 16. Use the code below to create a new table called ‘compare_metrics’ to make your exploration easier:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="lidar-for-forest-management.html#cb20-1" tabindex="-1"></a><span class="co">#Compare Plots 1 and 16</span></span>
<span id="cb20-2"><a href="lidar-for-forest-management.html#cb20-2" tabindex="-1"></a>compare_metrics <span class="ot">&lt;-</span>  mkrf_plot_metrics[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span>),]<span class="co">#create df of plots1,16)</span></span>
<span id="cb20-3"><a href="lidar-for-forest-management.html#cb20-3" tabindex="-1"></a><span class="fu">head</span>(compare_metrics)</span>
<span id="cb20-4"><a href="lidar-for-forest-management.html#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="lidar-for-forest-management.html#cb20-5" tabindex="-1"></a><span class="co">#Export mkrf_plot_metrics as .csv in Plots folder</span></span>
<span id="cb20-6"><a href="lidar-for-forest-management.html#cb20-6" tabindex="-1"></a><span class="fu">write_csv</span>(mkrf_plot_metrics, <span class="st">&quot;Plots/mkrf_plot_metrics.csv&quot;</span>)</span></code></pre></div>
<div id="q6-why-is-the-50th-heigh-percentile-so-different-between-the-two-plots-while-the-95th-height-percentile-is-so-similar" class="section level5 unnumbered hasAnchor">
<h5>Q6: Why is the 50th heigh percentile so different between the two plots while the 95th height percentile is so similar?<a href="lidar-for-forest-management.html#q6-why-is-the-50th-heigh-percentile-so-different-between-the-two-plots-while-the-95th-height-percentile-is-so-similar" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="q7-what-are-some-metrics-you-would-use-if-you-were-interested-in-measuring-the-vertical-complexity-of-a-stand-how-would-you-expect-these-metrics-to-vary-between-an-early-successional-stand-and-a-mature-stand-in-this-environment" class="section level5 unnumbered hasAnchor">
<h5>Q7: What are some metrics you would use if you were interested in measuring the vertical complexity of a stand? How would you expect these metrics to vary between an early successional stand and a mature stand in this environment?<a href="lidar-for-forest-management.html#q7-what-are-some-metrics-you-would-use-if-you-were-interested-in-measuring-the-vertical-complexity-of-a-stand-how-would-you-expect-these-metrics-to-vary-between-an-early-successional-stand-and-a-mature-stand-in-this-environment" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<hr />
</div>
</div>
<div id="task-7-individual-tree-detection" class="section level2 unnumbered hasAnchor">
<h2>Task 7: Individual Tree Detection<a href="lidar-for-forest-management.html#task-7-individual-tree-detection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="part-a-detect-individual-trees-from-a-point-cloud" class="section level4 unnumbered hasAnchor">
<h4>Part A) Detect individual trees from a point cloud<a href="lidar-for-forest-management.html#part-a-detect-individual-trees-from-a-point-cloud" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the first part of this task, we will detect individual trees using only the lidar point cloud data. To start, we will focus on Plot 1. This plot is located in a clearcut, where a number of trees were left standing. The crowns of these trees are clearly separated, so this plot is a good place to test our individual tree detection (i.e., we can compare detected trees against those we can see in the plot).</p>
<p>To detect individual trees, we will use the segment_trees function. There are multiple algorithms available in segment_trees and we recommend you explore each. For this section of the lab, we will use the li2012 algorithm. Please review the Li et al., 2012 paper if you wish understand how this algorithm works.</p>
<p>To run, this function requires multiple arguments. The first arguments are the adaptive thresholds, or dt1 and dt2 . These thresholds determine the distance that one point can be from another to be included in the same tree. They are considered adaptive because the algorithm chooses to use dt1 or dt2 based on the height of the seed point, which is a technical term for tree top. To be accurate, it is necessary to determine the spacing of trees within the area being classified. This can cause challenges because it is difficult to calculate tree spacing without first accurately segmenting individual trees.</p>
<p>The argument R refers to the search radius for points around the local maxima, which has been determined by Li et al., 2012 to be 2m in most cases.
The argument Zu determines which threshold is used by evaluating the height of the seed point. If Zu = 15 , then any seed point higher than 15m will use dt2 . Any seed point lower than 15m will use dt1. Li et al., 2012 have determined default values through trial and error: dt1 = 1.5 , dt2 = 2 , Zu = 15 , and R = 2</p>
<p>For this lab, we will use the default values determined by Li et al., 2012 for all arguments: dt1 = 1.5 , dt2 = 2 , R = 2 , Zu = 15 and speed_up = 10 . We will also use the default value for hmin , which is 2m, as it follows with previous labs in excluding points below 2m from our analyses.</p>
<p>Run <strong>Part A</strong> of the script now.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="lidar-for-forest-management.html#cb21-1" tabindex="-1"></a><span class="co">#Part A) Point Cloud based </span></span>
<span id="cb21-2"><a href="lidar-for-forest-management.html#cb21-2" tabindex="-1"></a>norm_mkrf <span class="ot">&lt;-</span> <span class="fu">readLAScatalog</span>(<span class="st">&quot;Normalized&quot;</span>)</span>
<span id="cb21-3"><a href="lidar-for-forest-management.html#cb21-3" tabindex="-1"></a><span class="fu">opt_filter</span>(norm_mkrf) <span class="ot">&lt;-</span> <span class="st">&quot;-keep_z_above 2 -drop_z_above 65&quot;</span></span>
<span id="cb21-4"><a href="lidar-for-forest-management.html#cb21-4" tabindex="-1"></a><span class="fu">plot</span>(norm_mkrf)</span>
<span id="cb21-5"><a href="lidar-for-forest-management.html#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="lidar-for-forest-management.html#cb21-6" tabindex="-1"></a><span class="co">#Plot Extraction</span></span>
<span id="cb21-7"><a href="lidar-for-forest-management.html#cb21-7" tabindex="-1"></a><span class="co">#load csv</span></span>
<span id="cb21-8"><a href="lidar-for-forest-management.html#cb21-8" tabindex="-1"></a>tree_meas <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Tree_Measurements.csv&quot;</span>)</span>
<span id="cb21-9"><a href="lidar-for-forest-management.html#cb21-9" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Lab6_Plots.csv&quot;</span>)</span>
<span id="cb21-10"><a href="lidar-for-forest-management.html#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="lidar-for-forest-management.html#cb21-11" tabindex="-1"></a><span class="co">#extract plots</span></span>
<span id="cb21-12"><a href="lidar-for-forest-management.html#cb21-12" tabindex="-1"></a>radius <span class="ot">&lt;-</span> <span class="dv">77</span> <span class="co">#the radius for clip_ircle()</span></span>
<span id="cb21-13"><a href="lidar-for-forest-management.html#cb21-13" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plots)){ <span class="co">#run the loop until i = the number of rows in &#39;plot_table&#39; (20)</span></span>
<span id="cb21-14"><a href="lidar-for-forest-management.html#cb21-14" tabindex="-1"></a>  plot_cent <span class="ot">&lt;-</span> <span class="fu">c</span>(plots<span class="sc">$</span>X[i], plots<span class="sc">$</span>Y[i]) <span class="co">#extract plot center</span></span>
<span id="cb21-15"><a href="lidar-for-forest-management.html#cb21-15" tabindex="-1"></a>  plot_las <span class="ot">&lt;-</span> <span class="fu">clip_circle</span>(norm_mkrf, plot_cent[<span class="dv">1</span>], plot_cent[<span class="dv">2</span>], radius) <span class="co">#clip plot from norm_cat_las</span></span>
<span id="cb21-16"><a href="lidar-for-forest-management.html#cb21-16" tabindex="-1"></a>  output_file <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Plots_ITD/Plot_&quot;</span>, i, <span class="st">&quot;.las&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>) <span class="co">#output directory as string</span></span>
<span id="cb21-17"><a href="lidar-for-forest-management.html#cb21-17" tabindex="-1"></a>  <span class="fu">writeLAS</span>(<span class="fu">assign</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot_&quot;</span>, i, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), plot_las), output_file) <span class="co">#write&#39;MKRF_Plot_i&#39; to output dir.</span></span>
<span id="cb21-18"><a href="lidar-for-forest-management.html#cb21-18" tabindex="-1"></a>}</span>
<span id="cb21-19"><a href="lidar-for-forest-management.html#cb21-19" tabindex="-1"></a><span class="co">#calculate `cloud_metrics` for each plot</span></span>
<span id="cb21-20"><a href="lidar-for-forest-management.html#cb21-20" tabindex="-1"></a>ITD_plot_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb21-21"><a href="lidar-for-forest-management.html#cb21-21" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plots)){ <span class="co">#for loop == number of rowns in plot_table (20)</span></span>
<span id="cb21-22"><a href="lidar-for-forest-management.html#cb21-22" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="fu">paste</span>(<span class="st">&quot;Plots_ITD/Plot_&quot;</span>, i, <span class="st">&quot;.las&quot;</span>, <span class="at">sep=</span> <span class="st">&quot;&quot;</span>), <span class="at">filter =</span> <span class="st">&quot;-keep_first -drop_z_below 2&quot;</span>) <span class="co">#keep only first returns and (65m &gt; points &gt; 2m)</span></span>
<span id="cb21-23"><a href="lidar-for-forest-management.html#cb21-23" tabindex="-1"></a>  metrics <span class="ot">&lt;-</span> <span class="fu">cloud_metrics</span>(plot, .stdmetrics) <span class="co">#compute metrics only on first return. Why?</span></span>
<span id="cb21-24"><a href="lidar-for-forest-management.html#cb21-24" tabindex="-1"></a>  ITD_plot_metrics <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ITD_plot_metrics, metrics)</span>
<span id="cb21-25"><a href="lidar-for-forest-management.html#cb21-25" tabindex="-1"></a>}</span>
<span id="cb21-26"><a href="lidar-for-forest-management.html#cb21-26" tabindex="-1"></a><span class="co">#segment each plot using li2012</span></span>
<span id="cb21-27"><a href="lidar-for-forest-management.html#cb21-27" tabindex="-1"></a>p1_li <span class="ot">=</span> <span class="fu">segment_trees</span>(Plot_1, <span class="fu">li2012</span>())</span>
<span id="cb21-28"><a href="lidar-for-forest-management.html#cb21-28" tabindex="-1"></a><span class="fu">plot</span>(p1_li, <span class="at">color =</span> <span class="st">&#39;treeID&#39;</span>)</span>
<span id="cb21-29"><a href="lidar-for-forest-management.html#cb21-29" tabindex="-1"></a><span class="co">#segment each plot</span></span>
<span id="cb21-30"><a href="lidar-for-forest-management.html#cb21-30" tabindex="-1"></a>p2_li <span class="ot">=</span> <span class="fu">segment_trees</span>(Plot_2, <span class="fu">li2012</span>())</span>
<span id="cb21-31"><a href="lidar-for-forest-management.html#cb21-31" tabindex="-1"></a><span class="fu">plot</span>(p2_li, <span class="at">color =</span> <span class="st">&#39;treeID&#39;</span>)</span></code></pre></div>
<div id="q8-describe-a-use-case-for-delineating-individual-trees-within-a-raw-point-cloud." class="section level5 unnumbered hasAnchor">
<h5>Q8: Describe a use case for delineating individual trees within a raw point cloud.<a href="lidar-for-forest-management.html#q8-describe-a-use-case-for-delineating-individual-trees-within-a-raw-point-cloud." class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="screenshot-3-include-a-figure-of-the-output-from-segmenting-each-plot-p1-p2" class="section level5 unnumbered hasAnchor">
<h5>Screenshot 3: Include a figure of the output from segmenting each plot (p1, p2)<a href="lidar-for-forest-management.html#screenshot-3-include-a-figure-of-the-output-from-segmenting-each-plot-p1-p2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="q9-running-the-code-lengthuniquep1_litreeid-counts-the-number-of-unique-treeids-in-plot-1.-there-are-94-unique-trees-within-this-plot.-based-on-screenshot-3-does-this-seem-reasonable-what-could-be-causing-discrepancies-between-the-tree-segmentation-and-the-number-of-actual-trees-in-the-plot" class="section level5 unnumbered hasAnchor">
<h5>Q9: Running the code <code>length(unique(p1_li$treeID))</code> counts the number of unique treeID’s in plot 1. There are 94 unique “trees” within this plot. Based on Screenshot 3, does this seem reasonable? What could be causing discrepancies between the tree segmentation and the number of actual trees in the plot?<a href="lidar-for-forest-management.html#q9-running-the-code-lengthuniquep1_litreeid-counts-the-number-of-unique-treeids-in-plot-1.-there-are-94-unique-trees-within-this-plot.-based-on-screenshot-3-does-this-seem-reasonable-what-could-be-causing-discrepancies-between-the-tree-segmentation-and-the-number-of-actual-trees-in-the-plot" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
</div>
<div id="part-b-detect-individual-trees-using-a-chm" class="section level4 unnumbered hasAnchor">
<h4>Part B) Detect individual trees using a CHM<a href="lidar-for-forest-management.html#part-b-detect-individual-trees-using-a-chm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the previous section of this lab we used raw point cloud information to detect individual trees. Now, we will use a CHM in an attempt to increase classification accuracy. There are a variety of CHM-based segmentation algorithms within lidR, but we will use the one presented by Dalponte and Coomes 2016.</p>
<p>We will use the Dalponte et al., 2016 algorithm. Explore the Help page for this algorithm to understand it’s details. You will notice that the arguments used in li2012 are different to those used in dalponte2016:</p>
<p>chm refers to a RasterLayer canopy height model.
treetops refers to the spatial location of individual trees determined by find_trees or an external shapefile</p>
<p>th_tree is the threshold below which a pixel cannot be a tree (default = 2)</p>
<p>th_seed is Growing Threshold 1 (default is 0.45)</p>
<p>th_cr is the Growing Threshold 2 (default is 0.55)</p>
<p>max_cr refers to the maximum value of the crown diameter of a detected tree (default = 10)</p>
<p>ID individual identification number of each tree.</p>
<p>Run <strong>Part B</strong> of the script now.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="lidar-for-forest-management.html#cb22-1" tabindex="-1"></a><span class="do">### Part b) CHM based</span></span>
<span id="cb22-2"><a href="lidar-for-forest-management.html#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="lidar-for-forest-management.html#cb22-3" tabindex="-1"></a><span class="co">#Dalponte et al., 2016 CHM-based </span></span>
<span id="cb22-4"><a href="lidar-for-forest-management.html#cb22-4" tabindex="-1"></a><span class="co">#create CHM with 0.5m res</span></span>
<span id="cb22-5"><a href="lidar-for-forest-management.html#cb22-5" tabindex="-1"></a>algo <span class="ot">=</span> <span class="fu">pitfree</span>(<span class="at">thresholds =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="at">max_edge =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">subcircle =</span> <span class="fl">0.2</span>)</span>
<span id="cb22-6"><a href="lidar-for-forest-management.html#cb22-6" tabindex="-1"></a>chm_1_0<span class="fl">.5</span>  <span class="ot">=</span> <span class="fu">grid_canopy</span>(Plot_1, <span class="fl">0.5</span>, algo)</span>
<span id="cb22-7"><a href="lidar-for-forest-management.html#cb22-7" tabindex="-1"></a><span class="fu">plot</span>(chm_1_0<span class="fl">.5</span>, <span class="at">col =</span> <span class="fu">height.colors</span>(<span class="dv">50</span>))</span>
<span id="cb22-8"><a href="lidar-for-forest-management.html#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="lidar-for-forest-management.html#cb22-9" tabindex="-1"></a><span class="co">#find treetops</span></span>
<span id="cb22-10"><a href="lidar-for-forest-management.html#cb22-10" tabindex="-1"></a>ttops_1 <span class="ot">&lt;-</span> <span class="fu">find_trees</span>(Plot_1, <span class="at">algorithm =</span> <span class="fu">lmf</span>(<span class="dv">5</span>, <span class="at">shape =</span> <span class="st">&quot;circular&quot;</span>))</span>
<span id="cb22-11"><a href="lidar-for-forest-management.html#cb22-11" tabindex="-1"></a><span class="co">#add ttops_1 to chm</span></span>
<span id="cb22-12"><a href="lidar-for-forest-management.html#cb22-12" tabindex="-1"></a><span class="fu">plot</span>(ttops_1, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="co">#adds ttops_1 to chm_1_0.5 plot; notice the variety of non-tree tops</span></span>
<span id="cb22-13"><a href="lidar-for-forest-management.html#cb22-13" tabindex="-1"></a></span>
<span id="cb22-14"><a href="lidar-for-forest-management.html#cb22-14" tabindex="-1"></a>dalponte_1_0<span class="fl">.5</span> <span class="ot">&lt;-</span> Plot_1 <span class="sc">%&gt;%</span> </span>
<span id="cb22-15"><a href="lidar-for-forest-management.html#cb22-15" tabindex="-1"></a>  <span class="fu">segment_trees</span>(<span class="fu">dalponte2016</span>(chm_1_0<span class="fl">.5</span>, ttops_1)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-16"><a href="lidar-for-forest-management.html#cb22-16" tabindex="-1"></a>  <span class="fu">filter_poi</span>(<span class="sc">!</span><span class="fu">is.na</span>(treeID))</span>
<span id="cb22-17"><a href="lidar-for-forest-management.html#cb22-17" tabindex="-1"></a></span>
<span id="cb22-18"><a href="lidar-for-forest-management.html#cb22-18" tabindex="-1"></a>crowns1 <span class="ot">&lt;-</span> <span class="fu">delineate_crowns</span>(dalponte_1_0<span class="fl">.5</span>)</span>
<span id="cb22-19"><a href="lidar-for-forest-management.html#cb22-19" tabindex="-1"></a><span class="fu">plot</span>(crowns1, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-20"><a href="lidar-for-forest-management.html#cb22-20" tabindex="-1"></a></span>
<span id="cb22-21"><a href="lidar-for-forest-management.html#cb22-21" tabindex="-1"></a><span class="do">####  PLOT 2</span></span>
<span id="cb22-22"><a href="lidar-for-forest-management.html#cb22-22" tabindex="-1"></a></span>
<span id="cb22-23"><a href="lidar-for-forest-management.html#cb22-23" tabindex="-1"></a><span class="co">#use dalponte with CHM for plot 2 at 0.5m resolution </span></span>
<span id="cb22-24"><a href="lidar-for-forest-management.html#cb22-24" tabindex="-1"></a>chm_2_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">grid_canopy</span>(Plot_2, <span class="fl">0.5</span>, algo)</span>
<span id="cb22-25"><a href="lidar-for-forest-management.html#cb22-25" tabindex="-1"></a><span class="fu">plot</span>(chm_2_0<span class="fl">.5</span>, <span class="at">col =</span> <span class="fu">height.colors</span>(<span class="dv">50</span>))</span>
<span id="cb22-26"><a href="lidar-for-forest-management.html#cb22-26" tabindex="-1"></a></span>
<span id="cb22-27"><a href="lidar-for-forest-management.html#cb22-27" tabindex="-1"></a>ttops_2 <span class="ot">&lt;-</span> <span class="fu">find_trees</span>(Plot_2, <span class="at">algorithm =</span> <span class="fu">lmf</span>(<span class="dv">5</span>, <span class="at">shape =</span> <span class="st">&quot;circular&quot;</span>))</span>
<span id="cb22-28"><a href="lidar-for-forest-management.html#cb22-28" tabindex="-1"></a><span class="co">#add ttops_2 to chm2</span></span>
<span id="cb22-29"><a href="lidar-for-forest-management.html#cb22-29" tabindex="-1"></a><span class="fu">plot</span>(ttops_2, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="co">#adds ttops_2 to chm_2_0.5 plot; notice the variety of non-tree tops</span></span>
<span id="cb22-30"><a href="lidar-for-forest-management.html#cb22-30" tabindex="-1"></a></span>
<span id="cb22-31"><a href="lidar-for-forest-management.html#cb22-31" tabindex="-1"></a><span class="co">#apply to point cloud</span></span>
<span id="cb22-32"><a href="lidar-for-forest-management.html#cb22-32" tabindex="-1"></a>dalponte_2_0<span class="fl">.5</span> <span class="ot">&lt;-</span> Plot_2 <span class="sc">%&gt;%</span> </span>
<span id="cb22-33"><a href="lidar-for-forest-management.html#cb22-33" tabindex="-1"></a>  <span class="fu">segment_trees</span>(<span class="fu">dalponte2016</span>(chm_2_0<span class="fl">.5</span>, ttops_2)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-34"><a href="lidar-for-forest-management.html#cb22-34" tabindex="-1"></a>  <span class="fu">filter_poi</span>(<span class="sc">!</span><span class="fu">is.na</span>(treeID))</span>
<span id="cb22-35"><a href="lidar-for-forest-management.html#cb22-35" tabindex="-1"></a></span>
<span id="cb22-36"><a href="lidar-for-forest-management.html#cb22-36" tabindex="-1"></a></span>
<span id="cb22-37"><a href="lidar-for-forest-management.html#cb22-37" tabindex="-1"></a><span class="co">#find crowns</span></span>
<span id="cb22-38"><a href="lidar-for-forest-management.html#cb22-38" tabindex="-1"></a>crowns2 <span class="ot">&lt;-</span> <span class="fu">delineate_crowns</span>(dalponte_2_0<span class="fl">.5</span>)</span>
<span id="cb22-39"><a href="lidar-for-forest-management.html#cb22-39" tabindex="-1"></a><span class="fu">plot</span>(crowns2, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="screenshot-4-include-a-figure-of-plot-2-showing-the-chm-within-delineated-crowns-and-tree-tops" class="section level5 unnumbered hasAnchor">
<h5>Screenshot 4: Include a figure of plot 2 showing the CHM within delineated crowns and tree tops<a href="lidar-for-forest-management.html#screenshot-4-include-a-figure-of-plot-2-showing-the-chm-within-delineated-crowns-and-tree-tops" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="q10-compare-the-two-chm-plots.-in-your-opinion-when-does-individual-tree-detection-work-well-and-where-does-it-fall-short.-explain." class="section level5 unnumbered hasAnchor">
<h5>Q10: Compare the two CHM plots. In your opinion when does individual tree detection work well and where does it fall short. Explain.<a href="lidar-for-forest-management.html#q10-compare-the-two-chm-plots.-in-your-opinion-when-does-individual-tree-detection-work-well-and-where-does-it-fall-short.-explain." class="anchor-section" aria-label="Anchor link to header"></a></h5>
<hr />
</div>
</div>
</div>
<div id="summary-5" class="section level2 unnumbered hasAnchor">
<h2>Summary<a href="lidar-for-forest-management.html#summary-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We started this lab with learning to install R and Rstudio and progressed quickly towards visualizing RGB and point cloud data, creating a DEM and CHM, extracting cloud_metrics, using an OLS regression to preduct forest attributes with lidar metrics, and using individual tree detection methods to find tall trees using points clouds. Packages like lidR and tidyverse allow us to conduct meaningful and important analysis with relatively few lines of code. This lab was just a few examples of important questions about our forests that can be modeled and answered using these tools! When moving forward and including these methods into your own workflows, remember the importance of getting to know your data and modeling methods. Ask yourself, what are these duplicate points doing to my processing times? How are these outlying points affecting my data? What model works best for the question I am trying to answer with my metrics? Are these variables equally important or are they highly correlated and I am fitting noise?</p>
<p>Return to the <a href="lidar-for-forest-management.html#lab6-deliverables"><strong>Deliverables</strong></a> section to check off everything you need to submit for credit in the course management system.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spectral-signatures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-series-image-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["open-geomatics-community-of-practice.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
