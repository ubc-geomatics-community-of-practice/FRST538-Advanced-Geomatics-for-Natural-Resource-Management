<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab: 1 Salmon Stream Network Analysis | FRST 538: Advanced Geomatics for Natural Resource Management</title>
  <meta name="description" content="Open Educational Resources for FRST 538 course at the University of British Columbia" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab: 1 Salmon Stream Network Analysis | FRST 538: Advanced Geomatics for Natural Resource Management" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Open Educational Resources for FRST 538 course at the University of British Columbia" />
  <meta name="github-repo" content="github.com/ubc-geomatics-community-of-practice/FRST538-Advanced-Geomatics-for-Natural-Resource-Management/book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab: 1 Salmon Stream Network Analysis | FRST 538: Advanced Geomatics for Natural Resource Management" />
  
  <meta name="twitter:description" content="Open Educational Resources for FRST 538 course at the University of British Columbia" />
  

<meta name="author" content="Paul D. Pickell" />


<meta name="date" content="2024-09-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="lidar-terrain.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Open Geomatics Community of Practice</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-these-resources"><i class="fa fa-check"></i>How to use these resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-get-involved"><i class="fa fa-check"></i>How to get involved</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="network-analysis.html"><a href="network-analysis.html"><i class="fa fa-check"></i><b>1</b> Salmon Stream Network Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#lab-overview"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#learning-objectives"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#lab1-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-1-create-stream-segments"><i class="fa fa-check"></i>Task 1: Create stream segments</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-2-create-routes-and-apply-topology"><i class="fa fa-check"></i>Task 2: Create routes and apply topology</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-3-record-stream-attributes-with-linear-referencing"><i class="fa fa-check"></i>Task 3: Record stream attributes with linear referencing</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-4-trace-the-network"><i class="fa fa-check"></i>Task 4: Trace the network</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#task-5-overlay-and-query-the-network"><i class="fa fa-check"></i>Task 5: Overlay and query the network</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#final-report"><i class="fa fa-check"></i>Final Report</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lidar-terrain.html"><a href="lidar-terrain.html"><i class="fa fa-check"></i><b>2</b> LiDAR, terrain models and geovisualization</a>
<ul>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#lab-overview-1"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#learning-objectives-1"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#lab2-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#lab2-data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-1-load-and-explore-the-lidar-data"><i class="fa fa-check"></i>Task 1: Load and explore the LiDAR data</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-2-create-a-dtm-using-built-in-arcgis-functions"><i class="fa fa-check"></i>Task 2: Create a DTM using built-in ArcGIS functions</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-3-pre-process-data-for-interpolation"><i class="fa fa-check"></i>Task 3: Pre-process data for interpolation</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-4-raster-interpolation"><i class="fa fa-check"></i>Task 4: Raster interpolation</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-5-visually-interpret-differences"><i class="fa fa-check"></i>Task 5: Visually interpret differences</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-6-quantitatively-interpret-the-differences-and-calculate-statistics-for-each-zone"><i class="fa fa-check"></i>Task 6: Quantitatively interpret the differences and calculate statistics for each zone</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-7-create-a-map-document"><i class="fa fa-check"></i>Task 7: Create a map document</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#task-8-exploring-scenes"><i class="fa fa-check"></i>Task 8: Exploring Scenes</a></li>
<li class="chapter" data-level="" data-path="lidar-terrain.html"><a href="lidar-terrain.html#summary-1"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html"><i class="fa fa-check"></i><b>3</b> Suitability and Overlay Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#lab-overview-2"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#learning-objectives-2"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#lab3-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#data-1"><i class="fa fa-check"></i>Data</a>
<ul>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#data-organization"><i class="fa fa-check"></i>Data Organization</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#files-to-create"><i class="fa fa-check"></i>Files to Create</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#scenario-1"><i class="fa fa-check"></i>Scenario 1</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-1-export-relevant-data-from-biologically-important-areas-shapefile"><i class="fa fa-check"></i>Task 1: Export Relevant Data from Biologically Important Areas Shapefile</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-2-identify-the-bia-of-the-humpback-whale-that-is-not-within-the-established-marine-sanctuary"><i class="fa fa-check"></i>Task 2: Identify the BIA of the Humpback Whale that is not within the established Marine Sanctuary</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-3-calculate-the-density-of-cetacean-sightings-using-the-bia-for-humpback-whales"><i class="fa fa-check"></i>Task 3: Calculate the Density of Cetacean Sightings using the BIA for Humpback Whales</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-4-extract-the-boats-from-ocean-uses-and-identity-the-vessels-within-the-bia-polygons"><i class="fa fa-check"></i>Task 4: Extract the Boats from Ocean Uses and Identity the Vessels within the BIA Polygons</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-5-calculate-suitability-and-identify-most-suitable-locations-for-the-marine-sanctuary"><i class="fa fa-check"></i>Task 5: Calculate Suitability and Identify Most Suitable Locations for the Marine Sanctuary</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#scenario-2"><i class="fa fa-check"></i>Scenario 2</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-1-export-relevant-data-from-biologically-important-areas-shapefile-1"><i class="fa fa-check"></i>Task 1: Export Relevant Data from Biologically Important Areas Shapefile</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-2-extract-all-of-the-commercial-fishing-vessels-from-ocean-uses"><i class="fa fa-check"></i>Task 2: Extract All of the Commercial Fishing Vessels from Ocean Uses</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#task-3-erase-where-the-false-killer-whales-and-commercial-fishing-vessels-overlap"><i class="fa fa-check"></i>Task 3: Erase where the False Killer Whales and Commercial Fishing Vessels overlap</a></li>
<li class="chapter" data-level="" data-path="suitability-overlay-analysis.html"><a href="suitability-overlay-analysis.html#summary-2"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html"><i class="fa fa-check"></i><b>4</b> Analyzing Green Equity Using Geographically Weighted Regression</a>
<ul>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#lab-overview-3"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#learning-objectives-3"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#lab4-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#lab4-data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#task-1-visualize-census-data"><i class="fa fa-check"></i>Task 1: Visualize census data</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#task-2-practice-geographically-weighted-regression"><i class="fa fa-check"></i>Task 2: Practice geographically weighted regression</a></li>
<li class="chapter" data-level="" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#summary-3"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spectral-signatures.html"><a href="spectral-signatures.html"><i class="fa fa-check"></i><b>5</b> Getting to know Remote Sensing and spectral signatures</a>
<ul>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#lab-overview-4"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#learning-objectives-4"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#lab5-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#data-2"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#task-1-the-electromagnetic-spectrum"><i class="fa fa-check"></i>Task 1: The Electromagnetic Spectrum</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#task-2-landsat-5-bands-the-ems-arcgis-pro-software"><i class="fa fa-check"></i>Task 2: Landsat 5 Bands, the EMS, &amp; ArcGIS Pro Software</a></li>
<li class="chapter" data-level="" data-path="spectral-signatures.html"><a href="spectral-signatures.html#summary-4"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html"><i class="fa fa-check"></i><b>6</b> Lidar for Forest Management</a>
<ul>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#lab-overview-5"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#learning-objectives-5"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#lab6-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#data-3"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#lab-set-up"><i class="fa fa-check"></i>Lab Set up</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-1-load-rgb-imagery"><i class="fa fa-check"></i>Task 1: Load RGB Imagery</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-2-load-and-explore-the-lidar-data"><i class="fa fa-check"></i>Task 2: Load and Explore the LiDAR Data</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-3-read-multiple-las-files-into-lascatolog-object"><i class="fa fa-check"></i>Task 3: Read Multiple LAS Files into LAScatolog object</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-4-create-digital-elevation-model-dem"><i class="fa fa-check"></i>Task 4: Create Digital Elevation Model (DEM)</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-5-create-a-canopy-height-model"><i class="fa fa-check"></i>Task 5: Create a Canopy Height Model</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-6-extract-metrics-from-the-point-clouds"><i class="fa fa-check"></i>Task 6: Extract Metrics From the Point Clouds</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-7-stem-volume-models-with-lidr"><i class="fa fa-check"></i>Task 7: Stem Volume Models with lidR</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#task-8-individual-tree-detection"><i class="fa fa-check"></i>Task 8: Individual Tree Detection</a></li>
<li class="chapter" data-level="" data-path="lidar-for-forest-management.html"><a href="lidar-for-forest-management.html#summary-5"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html"><i class="fa fa-check"></i><b>7</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#lab-overview-6"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#learning-objectives-6"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#lab7-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#data-4"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#task-1-starting-arcgis-pro"><i class="fa fa-check"></i>Task 1: Starting ArcGIS Pro</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#toggling-extentions"><i class="fa fa-check"></i>Toggling Extentions</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#inserting-a-new-map"><i class="fa fa-check"></i>Inserting a New Map</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#adding-data-to-the-map"><i class="fa fa-check"></i>Adding Data to the Map</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#task-1-calculating-ndvi"><i class="fa fa-check"></i>Task 1: Calculating NDVI</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#task-2-time-series-analysis"><i class="fa fa-check"></i>Task 2: Time Series Analysis</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#task-3-change-detection"><i class="fa fa-check"></i>Task 3: Change Detection</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#task-4-map-creation"><i class="fa fa-check"></i>Task 4: Map Creation</a></li>
<li class="chapter" data-level="" data-path="time-series-image-analysis.html"><a href="time-series-image-analysis.html#summary-6"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html"><i class="fa fa-check"></i><b>8</b> Machine Learning for Classification</a>
<ul>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#lab-overview-7"><i class="fa fa-check"></i>Lab Overview</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#learning-objectives-7"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#lab8-deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#data-5"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#task-1-creating-training-data"><i class="fa fa-check"></i>Task 1: Creating training data</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#task-2-training-a-random-forest-random-forest-algorithm"><i class="fa fa-check"></i>Task 2: Training a Random Forest (Random Forest Algorithm)</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#task-3-interpreting-classification-results"><i class="fa fa-check"></i>Task 3: Interpreting Classification Results</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#task-4-making-a-map"><i class="fa fa-check"></i>Task 4: Making a Map</a></li>
<li class="chapter" data-level="" data-path="machine-learning-for-classification.html"><a href="machine-learning-for-classification.html#summary-7"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">FRST 538: Advanced Geomatics for Natural Resource Management</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="network-analysis" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Lab: 1</span> Salmon Stream Network Analysis<a href="network-analysis.html#network-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Written by
Paul Pickell</p>
<div id="lab-overview" class="section level2 unnumbered hasAnchor">
<h2>Lab Overview<a href="network-analysis.html#lab-overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An important application of GIS for watershed management is characterizing the physical components of streams, rivers, and water bodies. In this lab, you will learn how to use the Hydrology, Network Analyst, and Linear Referencing toolsets in ArcGIS Pro to extract hydrologic information from a digital elevation model (DEM) in order to model a network of streams.</p>
<p>In British Columbia, salmon are an important species for economic, cultural, and ecological reasons. Thus, there is extensive research and management efforts to better understand and sustainably manage salmon populations. There are five Pacific salmon species, Chinook, Coho, Chum, Pink, and Sockeye salmon. Salmon are diadromous species, spending their lifecycle in both freshwater and the ocean. We are particularly interested in habitat for salmon spawning. Salmon return to freshwater habitats to spawn and there are various requirements for salmon spawning that differ by species:</p>
<ul>
<li><p>Stream order</p></li>
<li><p>Proximity to a lake</p></li>
<li><p>Upwelling/downwelling</p></li>
<li><p>Water quality</p></li>
<li><p>Water depth</p></li>
<li><p>Water velocity</p></li>
<li><p>Substrate material</p></li>
<li><p>Slope gradient</p></li>
<li><p>Land cover</p></li>
</ul>
<p>For this lab, you will identify the preferred habitat for salmon spawning based on proxy measures and how it corresponds to our stream network that we have derived from the DEM. This lab will walk you through how to measure stream order and slope. For your final report, you will also be expected to analyze an additional habitat requirement for salmon spawning. (Note: if you use some information that is not on the aforementioned list, please describe how it is a habitat requirement for salmon spawning in your report.)</p>
<p>In this lab, we will focus on Vancouver Island for a few reasons. First, islands make it possible to calculate flow accumulation exactly, which is important for creating a (nearly) topologically correct stream network. Second, Vancouver Island is large, which will enable us to look at natural sources of topological errors. Third, many species of Pacific salmon return to highly developed Vancouver Island to spawn and often come into conflict with human development.</p>
<hr />
</div>
<div id="learning-objectives" class="section level2 unnumbered hasAnchor">
<h2>Learning Objectives<a href="network-analysis.html#learning-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Derive hydrology layers from a DEM</p></li>
<li><p>Model dams on streams as barriers by applying network topology</p></li>
<li><p>Evaluate a capability model of salmon habitat along stream segments using linear referencing</p></li>
<li><p>Trace a stream network and calculate reachable upstream salmon habitat</p></li>
</ul>
<hr />
</div>
<div id="lab1-deliverables" class="section level2 unnumbered hasAnchor">
<h2>Deliverables<a href="network-analysis.html#lab1-deliverables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The lab deliverables to be submitted on canvas include:</p>
<p>Lab report with the following specifications:</p>
<p><input type="checkbox" unchecked> Map showing the reach of your streams from the ocean with dams as barriers </input></p>
<p><input type="checkbox" unchecked> Map showing the salmon conservation unit that you have selected to focus on </input></p>
<p><input type="checkbox" unchecked> 4 pages maximum PDF including findings and anwers to the questions at the end of the lab </input></p>
<p><input type="checkbox" unchecked> Report should satisfy the following requirements:</input></p>
<ul>
<li>1” margins</li>
<li>12 point font</li>
<li>single spaced</li>
<li>maximum of four pages</li>
<li>use headings as needed</li>
<li>omit your name, student number, date</li>
</ul>
<hr />
</div>
<div id="data" class="section level2 unnumbered hasAnchor">
<h2>Data<a href="network-analysis.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>vancouver_island_dem</strong></p>
<p>To save time for this lab, the DEM has already been assembled and pre-processed for you. This was the general process applied to create the DEM in case you want to reproduce it or apply the same method for another project:</p>
<ol style="list-style-type: decimal">
<li>Download all the tiles for Vancouver Island from the B.C. Government <a href="https://www2.gov.bc.ca/gov/content/data/geographic-data-services/topographic-data/elevation">here</a></li>
<li>Mosaic the rasters together using the “Mosaic to new raster” tool</li>
<li>Buffer a polygon shapefile of Vancouver Island by 25 m</li>
<li>Convert the result of step 3 to a raster with cell size 25 m and project to NAD 1983 BC Environment Albers. This is a mask that extends just beyond the shore of Vancouver Island to account for mapping errors.</li>
<li>Extract the DEM from step 2 by the mask in step 4 to produce a DEM for only Vancouver Island that excludes all other nearby islands:</li>
</ol>
<p><img src="images/02-vancouver-island-dem.png" width="100%" /></p>
<p><strong>vancouver_island_dem</strong>
The DEM above was filtered several times for sinks. Generally, you can use the “Fill” tool to achieve this. However, Vancouver Island has many naturally-occurring geomorphic features that can cause real sinks (as opposed to random errors). In order to create a depressionless DEM, the DEM was iteratively put through the following process:</p>
<ol style="list-style-type: decimal">
<li>Calculate flow direction</li>
<li>Calculate sinks</li>
<li>Calculate watersheds using the flow direction raster and the sinks raster as pour points</li>
<li>Calculate minimum elevation of the sinks using the “Zonal statistics” tool</li>
<li>Calculate maximum elevation of the watershed for the sink using the “Zonal fill” tool</li>
<li>Subtract result of step 4 from result of step 5 for the sinks mapped in step 2. This is the depth of each sink.</li>
<li>Add the sink depth to the DEM to fill the sink</li>
<li>Repeat steps 1-7 several times until you remove all sinks or achieve a stopping criterion</li>
</ol>
<p>The original DEM contained &gt;3,000 sinks. After iterating the above 12 times, there were fewer than 300 sinks. You can subtract the DEM from the filled DEM to observe where fill was added. Notice any patterns for where sinks are located on the island?</p>
<p><strong>dams</strong></p>
<p>The dams were acquired from the BC Government <a href="https://catalogue.data.gov.bc.ca/dataset/bc-dams">here</a>. These data were clipped to Vancouver Island and represent dam structures as polyline features.</p>
<p><strong>Salmon conservation units (CU)</strong></p>
<p>Conservation units for Chinook, Chum, and Coho were acquired from Oceans and Fisheries Canada <a href="https://open.canada.ca/data/en/dataset/1ac00a39-4770-443d-8a6b-9656c06df6a3#wb-auto-6">here</a>. These polygon areas were mapped considering ecology, life history, and molecular genetics (<a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1095-8649.2001.tb01376.x">Waples et al 2001</a>).</p>
<hr />
</div>
<div id="task-1-create-stream-segments" class="section level2 unnumbered hasAnchor">
<h2>Task 1: Create stream segments<a href="network-analysis.html#task-1-create-stream-segments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Step 1</strong>: Before starting the lab, you will need to download all of the data from Canvas.</p>
<p><strong>Step 2:</strong> Open ArcGIS Pro. You should have window that looks like the screenshot below. The ArcGIS Pro theme used to create this lab is Dark. The default theme is likely Light, but if you are interested in changing themes please follow the instructions at this <a href="https://pro.arcgis.com/en/pro-app/latest/get-started/general-options.htm">link</a>. To open a new project, choose “Map” from the “New Blank Template” list.</p>
<p><img src="images/01-starting-arcgispro-prompt.png" width="100%" style="display: block; margin: auto;" /></p>
<p>A prompt will appear requesting you to Name and state the location of your project. It is recommended to name your project “LabXX_yourlastname”. Uncheck the “Create a new folder for this project” box. As usual, save your project on the (C:) drive in the same folder that your downloaded data is located.</p>
<p>The next window is the generic start of a new project in ArcGIS Pro. In the centre you will see the standard “Catalog” frame. At the top is the ribbon, which is where the majority of your analysis options can be found. On the left is the standard “Contents” frame, which is similar to that of other Esri products. Tabs can be found on the right-hand side of the window. When using tools or adjusting symbology, be sure to look here for a relevant tab before exploring the ribbon.</p>
<p>You will also notice that the Catolog frame is also “tabbed”. This means that you can close the frame without closing ArcGIS Pro. It also means that you can have Maps, Catalogs and 3D Scenes all open at the same time. Although this is very cool, be aware that too many tabs are likely to crash ArcGIS Pro. Know your computers processing limits and play within it.</p>
<p><strong>Step 3:</strong> Without closing the Catalog window, navigate to the “Insert” tab on the ribbon and click on the “New Map” icon.</p>
<p><img src="images/01-new-map.png" width="50%" style="display: block; margin: auto;" /></p>
<p>A new topographic map will appear in the centre window. Note that it is separate from the Catalog tab. You can switch back and forth between these as you wish, but recall that there is another Catalog tab on the right-hand side of the screen. When analyzing a map or editing a model, this is the easiest tab to use. For the remainder of the lab, when “Catalog” is mentioned it is referring to this side tab.</p>
<p><strong>Step 4:</strong> To add data to the map, navigate to the Pre-Lab folder using Catalog* ,if you save your project in the same folder as you data it should appear, if not right click <strong>Folders</strong> in the Catalog pane and select:</p>
<p><img src="images/01-add-folder-connection.png" width="50%" style="display: block; margin: auto;" /></p>
<p><strong>Step 5:</strong> Navigate to where the data is saved and click ok. When you can find the data folder, drag-and-drop the <strong>vancouver_island_dem</strong> file into the map window. At this point, you should see a DEM covering Vancouver Island. If the mapview does not immediately pan to the image right click <strong>vancouver_island_dem</strong> in the Contents pane and press Zoom to Layer.</p>
<p><em>Note: If the catalog pane does not immediately appear in your ArcGIS Pro document use the ribbons at the top to navigate to <strong>View -&gt; Catalog Pane</strong></em></p>
<p><img src="images/01-catalog-pane.png" width="50%" style="display: block; margin: auto;" /></p>
<p><strong>Step 6:</strong> Clip the DEM to the”vancouver_island_boundary” using the clip raster tool, toggle on “use input features for clipping geometry”.</p>
<p>You should save all of your outputs from the tools in this lab directly into your ArcGIS Pro project geodatabase. The reasoning for this is because we will only be working in ArcGIS Pro for this lab and also because the ArcGIS Pro topology tools only work with data inside an ArcGIS Pro geodatabase.</p>
<p>Calculate the flow direction of the filled DEM, using the “Flow Direction” tool. The flow direction tool determines which raster cells flow into other cells based on the elevation difference the immediate neighborhood. Keep the defaults of the tool. Ensure that “Force all edge cells to flow outward” is toggled on and leave all other parameters with the default value. The cell values in the output raster represent the steepest down slope direction of each pixel.</p>
<p><img src="images/02-flow-direction.png" width="50%" /></p>
<p><strong>Step 7:</strong> Use the output from the “Flow Direction” tool as an input into the “Flow Accumulation” tool. Again, use the defaults within the tool, but select integer as the output data type because the output of this tool is a count. This tool will create a raster that represents the number of pixels that will accumulate into any given pixel. You may need to zoom into the output to be able to see these streams. Play around with the symbology to visualize the stream network. (Hint: try using classify and various methods within symbology).</p>
<p><strong>Step 8:</strong> To define streams, you need to set a threshold for the flow accumulation. Open “Con”(Image Analyst Tools). This tool allows you to set a true/false condition and assign values to a new raster based on whether the condition is met. Set the expression so that a pixel that has a count equal to or more than 1000 will be assigned a value of 1. For “Input true raster or constant value”, use value 1. For “Input false raster or constant value”, use value 0.</p>
<p><img src="images/02-con.png" width="50%" /></p>
<p><strong>Step 9:</strong> Next, you will create a grid of stream links, which assigns unique values to each stream segment, so that the user can see how the streams are connected. Open the “Stream Link” tool and use the output from the “Con” tool and the flow direction raster here.</p>
<p><strong>Step 10:</strong> You will also use the “Stream Order” tool using the same inputs as in step 4 and the default parameters. The “Stream Order” tool assigns a numeric order to segments of the raster, essentially classifying branches of the stream network. The lowest order streams do not have any other streams that flow into it, while higher order streams can have multiple levels of tributaries that flow into it. This tool will take some time to run on the whole island. Take a moment to stretch and hydrate!</p>
<p><strong>Step 11:</strong> You will also convert your raster into polylines using the stream links raster and flow direction raster as inputs for the “Stream to Feature” tool. Toggle off “Simplify polylines”.</p>
<p>Below is a useful flowchart of the process of creating a stream network from a DEM (<a href="https://pro.arcgis.com/en/pro-app/tool-reference/spatial-analyst/deriving-runoff-characteristics.htm">ArcGIS Pro</a>).</p>
<p><img src="images/02-flow-chart.png" width="75%" /></p>
<hr />
</div>
<div id="task-2-create-routes-and-apply-topology" class="section level2 unnumbered hasAnchor">
<h2>Task 2: Create routes and apply topology<a href="network-analysis.html#task-2-create-routes-and-apply-topology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At this point, you have only created polyline features representing streams. Next we will convert those segments to routes and apply topology for our streams, as well as incorporate dams into the network.</p>
<p><img src="images/02-create-routes.png" width="75%" /></p>
<p><strong>Step 1:</strong> Create a blank feature dataset and name it “stream_routes_dams”. To do this, right-click the geodatabase in the Catalog pane and select New Feature Dataset. For the projection, use NAD 1983 BC Environment Albers (EPSG: 3005).</p>
<p><strong>Step 2:</strong> Convert your stream features into routes using the “Create routes” tool. Set the Route ID field to “arcid”. The coordinate Priority parameter can be set to any corner. When you go to save your output, navigate into your feature dataset (it “feels” like entering another folder from the Catalog view), and save the output as “vancouver_island_stream_routes”.</p>
<p><strong>Step 3:</strong> Right-click on the feature dataset, select “Import”, and then navigate to the <strong>dams</strong> layer from the lab data package.</p>
<p>The dams are modelled as polylines. We need to identify where these dams intersect the stream routes. We want to return a single point for that location so that we can properly model the dams in our network, which act as barriers to salmon as they travel through the stream network. We will use topology to achieve this.</p>
<p><img src="images/02-example-dam.png" width="100%" /></p>
<p><strong>Step 4:</strong> Right-click the feature dataset and select “New” and “Topology”. This will open the Create Topology Wizard dialogue box.</p>
<p><strong>Step 5:</strong> On the first page of the wizard, toggle on the dams and stream routes feature classes.</p>
<p><img src="images/02-create-topology-1.png" width="100%" /></p>
<p><strong>Step 6:</strong> On the second page of the wizard, add a new rule so that the stream polylines must not intersect with the dam polylines.</p>
<p><img src="images/02-create-topology-2.png" width="100%" /></p>
<p>Once done, click “Finish”. Refresh the feature dataset in the Catalog pane to see the new Topology.</p>
<p><strong>Step 7:</strong> Validate the topology by right-clicking the topology in the feature dataset and clicking “Validate”.</p>
<p><img src="images/02-topology-errors.png" width="25%" /></p>
<p><strong>Step 8:</strong> You can click and drag the topology into the map to view any errors. We expect there to be errors because we know that the dams should intersect with our stream routes. You should see red squares all over the island. In the Contents Pane, right-click the “Point Errors” layer, select “Data”, and select “Export Features”. Save the points to your feature dataset as “stream_dam_junctions”.</p>
<p>At this point, take a moment to appreciate where we are in this problem. We have modelled streams as routes and we now know where dams intersect with those routes. Salmon are diadromous species, they swim from the saltwater ocean up the freshwater streams to spawn. Therefore, we need one more piece of information in order to model how salmon swim upstream. We need to know where the streams meet the ocean.</p>
<p><strong>Step 9:</strong> Take the Vancouver Island boundary polygon provided and perform a negative buffer, called a nibble. Use -25 meters for the buffer distance. We are doing a negative buffer because we want to ensure that this edge intersects with the streams that terminate at the ocean. Remember that the streams were generated by an imperfect and imprecise DEM, therefore this process will ensure that every stream that reaches the ocean will intersect this boundary.</p>
<p><strong>Step 10:</strong> Convert the nibbled Vancouver Island boundary to a polyline using the “Polygon to line” tool. Be sure to toggle off “Identify and store polygon neighboring information”. <strong>Save the result to your feature dataset with the stream links and dams.</strong></p>
<p>Next, we will use the same topology process to identify where the island boundary intersects the stream routes, representing where salmon enter the stream network from the ocean.</p>
<p><strong>Step 11:</strong> Right-click the network topology in the Catalog and select “Properties”. This will open the topology wizard dialogue again. On the left, select “Feature Class” and toggle on the nibbled Vancouver island boundary that you created in step 10 and the stream routes. Toggle everything else off. On the left, select “Rules”. Highlight the previous rule and click the “Remove” button at the top. Then, add a rule so that the stream routes must not intersect with the nibbled island boundary. Refer to steps 5 and 6 above if you need clarification.</p>
<p><strong>Step 12:</strong> Again, validate the topology, add the topology to the map view, and export the Point Errors to a point feature class in your feature dataset. Name it “stream_ocean_junctions”. Refer to steps 7 and 8 if you need clarification.</p>
<p><img src="images/02-ocean-stream-junctions.png" width="100%" /></p>
<hr />
</div>
<div id="task-3-record-stream-attributes-with-linear-referencing" class="section level2 unnumbered hasAnchor">
<h2>Task 3: Record stream attributes with linear referencing<a href="network-analysis.html#task-3-record-stream-attributes-with-linear-referencing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have stream routes, we can calculate some information that relate to salmon habitat. Water quality is important for salmon spawning habitat. Steeper gradients (slope) may be more susceptible to erosion that could be one proxy for lower water quality. In this task, you will practice extracting information about the streams and storing that information in the routes using linear referencing.</p>
<p><strong>Important:</strong> Some of these operations can be computationally intensive because we will be dealing with up to 10<sup>5</sup> features for the entire island. You can attempt to process the entire island, but ultimately you need to clip your stream routes to one of the conservation units (CU) for any of the three species of salmon for your report.</p>
<p><strong>Step 1:</strong> Calculate the slope of the filled DEM using “Percent rise” as the output measurement and “Planar” as the Method.</p>
<p><strong>Step 2:</strong> Now use the “Extract by Mask” tool to extract the slope raster by the mask of the stream links raster you created back in Task 1. This will produce a raster with slope values only where our streams exist.</p>
<p><strong>Step 3:</strong> In British Columbia, stream gradients &lt; 20% are generally considered to be fish-bearing. Therefore, use the “Reclassify” tool to classify slopes &lt; 20% to a value of 1 and all other slopes to a value of 0 for the stream raster you created in the last step.</p>
<p><strong>Step 4:</strong> Use the “Stream to Feature” tool to convert the classified slope raster to line features. Parameterize this tool as follows:</p>
<ul>
<li><p>Input stream raster is the classified slope raster you just made in step 3</p></li>
<li><p>Input flow direction raster is the original flow direction raster you made in Task 1</p></li>
<li><p>Name the output “stream_features_slope_classified”</p></li>
<li><p><strong>Uncheck</strong> “Simplify polygons”</p></li>
</ul>
<p>Now you have another feature class of streams that should spatially match your stream routes, but these new polylines contain the gradient information. Now we will overlay this information with the routes. Open the attribute table of this layer, the field “grid_code” stores the value of the reclassified slope raster for each stream segment.</p>
<p><strong>Step 5:</strong> Use the “Locate Features Along Routes” tool to overlay the gradient information with the routes.</p>
<p><img src="images/02-locate-features-along-routes.png" width="75%" /></p>
<p>This will produce a route event table that should look something like this:</p>
<p><img src="images/02-stream-routes-gradient.png" width="75%" /></p>
<p>grid_code in the event table represents the classified stream gradient (0 is ≥20%, 1 is &lt;20%). Note that you have more records in this table than you have routes, because many routes are being segmented based on the gradient. Thus, you see repeating route id”s (RID).</p>
<p>Add a Short field to the event table called “GRADIENT” and calculate this field as !grid_code! to transfer the grid_code values to a more meaningful field name.</p>
<p><strong>Step 6:</strong> Repeat steps 4 and 5 above for the stream order raster that you generated in Task 1. Ensure that the stream_order raster is used as the “Input stream raster” and “Simplify polygons” is toggled off. In the end, you should have a second event table where the grid_code (values between 1 and 6) indicates the stream order for each route. Again, add a Short field to the event table called “SORDER” and calculate this field as !grid_code! to transfer the grid_code values to a more meaningful field name.</p>
<hr />
</div>
<div id="task-4-trace-the-network" class="section level2 unnumbered hasAnchor">
<h2>Task 4: Trace the network<a href="network-analysis.html#task-4-trace-the-network" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we can create a network that will allow us to trace the routes from the ocean to the dams. The goal of this task is to identify routes through the stream network that flow to the ocean and are unimpeded by dams. The following link provides more information about trace networks in ArcGIS Pro: <a href="https://pro.arcgis.com/en/pro-app/latest/help/data/trace-network/what-is-a-trace-network-.htm" class="uri">https://pro.arcgis.com/en/pro-app/latest/help/data/trace-network/what-is-a-trace-network-.htm</a></p>
<p>The following steps will use the “stream_dams_junction”, “stream_ocean_junctions” and the “vancouver_island_stream_routes” layers. Before running the next steps save your ArcGIS Project. Ensure you have cleared any selected features from the map.</p>
<p><strong>Step 1:</strong> Open the “Create Trace Network” tool:</p>
<ul>
<li><p>The Input Feature Dataset should point to your feature dataset in your geodatabase</p></li>
<li><p>Trace Network Name can be named “stream_trace_network”</p></li>
<li><p>Input Junctions should contain both the “stream_dams_junction” and “stream_ocean_junctions” from the Topology geodatabase.</p></li>
<li><p>Input Edges should contain the clipped stream routes and set the Connectivity Policy to “Complex edge”</p></li>
</ul>
<p><img src="images/02-create-trace-network.png" width="50%" /></p>
<p><strong>Step 2:</strong> Run the “Enable Network Topology” tool on the trace network you just created.</p>
<p><strong>Step 3:</strong> Run the “Validate Network Topology” tool on the trace network you just created. You might receive a warning: "A dirty area is not present within the specific extent." Ignore it.</p>
<p><strong>Step 4:</strong> Open the “Trace” tool. This tool traces a path along a network the meets specified criteria. It also supports modelling barriers, so that the tracing terminates when a barrier feature is reached. Here is how we will parameterize this tool:</p>
<ul>
<li><p>Input Trace Network is the trace network that you created earlier</p></li>
<li><p>Trace Type is “Connected”</p></li>
<li><p>Starting Points are the “stream_ocean_junctions” (make sure this is the layer stored in the Topology geodatabase)</p></li>
<li><p>Barriers are the “stream_dam_junctions” (make sure this is the layer stored in the Topology geodatabase)</p></li>
<li><p>Toggle on “Include Barrier Features”</p></li>
<li><p>Toggle off “Validate Consistency”</p></li>
<li><p>Toggle off “Ignore Barriers at Starting Points”</p></li>
<li><p>Leave all Advanced Options as defaults</p></li>
</ul>
<p>After the tool has finished running, toggle off the stream trace network and toggle on the stream routes layer (“vancouver_island_stream_routes”). You should see some of the routes are now highlighted on your map.</p>
<p><img src="images/02-trace.png" width="50%" /></p>
<p><strong>Step 5:</strong> Add a Short field to the stream routes attribute table called “REACHED”. Calculate this field with a value of “1” for the routes selected. Invert the selection and calculate the field again for the selected features with a value of “0”. Finally, clear the selection and symbolize the routes based on the “REACHED” field. Congratulations! You have now modeled which route segments can be reached from the ocean and are not impeded by dams. Your stream_routes should look something like this (blue = unimpeded streams, yellow = stream reaches that are impeded by a dam):</p>
<p><img src="images/02-traced-network.png" width="100%" /></p>
<p><strong>Important:</strong> If your map looks significantly different from above, like most of the streams are impeded, then try these fixes:</p>
<ul>
<li><p>Zoom in closely to the ocean and dam junctions to ensure they are overlapping with the stream routes.</p></li>
<li><p>Apply a new topology rule that dam/ocean junctions must be coincident with the stream routes.</p></li>
<li><p>If there are any errors from above, then use the “Snap” tool to force the ocean and dam junctions to. The input features are the features that you want to move (snap), in this case the ocean and dam junction points. The type should be set to “Edge” and usually a distance of 25-30 meters is sufficient, but check the output</p></li>
<li><p>If you are still having trouble, try deleting the Trace Network from the feature dataset and rebuilding it (“Create Trace Network” + “Enable Network Topology” + “Validate Network Topology”).</p></li>
<li><p>If you are unable to delete the trace network, your geodatabase may be corrupt. Try creating a new geodatabase and import or re-create the important feature classes. Then, re-create the feature dataset and rebuild the trace network.</p></li>
</ul>
<hr />
</div>
<div id="task-5-overlay-and-query-the-network" class="section level2 unnumbered hasAnchor">
<h2>Task 5: Overlay and query the network<a href="network-analysis.html#task-5-overlay-and-query-the-network" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now you will practice doing an overlay with your route event tables to transfer all the attributes into a common linear referencing system. This will allow you to then query the network for stream segments that meet some basic conditions for salmon habitat.</p>
<p><strong>Step 1:</strong> Parameterize the “Overlay Route Events” tool like below:</p>
<ul>
<li><p>Input Event Table is your classified gradient event table from Task 3</p></li>
<li><p>Overlay Event Table is the stream order event table from Task 3</p></li>
<li><p>From-Measure Field is FMEAS</p></li>
<li><p>To-Measure Field is TMEAS for both input event tables and the output event table</p></li>
<li><p>Type of Overlay is Intersect</p></li>
<li><p>Name the Output Event Table “stream_route_overlay”</p></li>
<li><p>Leave the Route Identifier Field empty for the output, but ensure it is set to RID for both the input tables</p></li>
</ul>
<p><img src="images/02-overlay-route-events.png" width="50%" /></p>
<p>This will produce a new output event table that contains the intersection of stream gradient and stream order along the routes. As well, this event table should contain which routes can be reached from the ocean before running into a dam. Keep in mind that this is just a table, not a feature class. This is known as dynamic segmentation. Next we will add one last field, visualize the everything and do a simple query.</p>
<p><strong>Step 2:</strong> Join the field “REACHED” from the original routes to the overlay event table you just created using the “Join Field” tool. The stream_routes layer should be the layer with the REACHED field:</p>
<p><img src="images/02-join-field.png" width="50%" /></p>
<p>You should now have a table that has all the fields we need: SORDER, GRADIENT, and REACHED. (Note that some fields have been hidden from view in the table below.)</p>
<p><img src="images/02-stream-route-overlay.png" width="100%" /></p>
<p><strong>Step 3:</strong> Use the “Make Route Event Layer” tool to convert the output event table to a feature class. Parameterize the tool as follows:</p>
<ul>
<li><p>Input route features will be the routes you originally created in Task 1</p></li>
<li><p>Route identifier field is “arcid”</p></li>
<li><p>Input event table is the “stream_route_overlay” table that you created from step 1</p></li>
<li><p>From-measure field is “FMEAS”</p></li>
<li><p>To-measure field is “TMEAS”</p></li>
<li><p>Layer name or Table view is “stream_route_overlay_layer”</p></li>
</ul>
<p><strong>Step 4:</strong> Query the event layer from step 2 for stream segments with the following requirements:</p>
<ul>
<li><p><u><strong>Can</strong></u> be reached from the ocean</p></li>
<li><p>Is 1<sup>st</sup> or 2<sup>nd</sup> order stream</p></li>
<li><p>Has a gradient not steeper than 20%</p></li>
</ul>
<p>Export the selected features to a new feature class called “accessible_salmon_habitat”.</p>
<p><strong>Step 5:</strong> Repeat the query using the following requirements:</p>
<ul>
<li><p><u><strong>Cannot</strong></u> be reached from the ocean</p></li>
<li><p>Is 1<sup>st</sup> or 2<sup>nd</sup> order stream</p></li>
<li><p>Has a gradient not steeper than 20%</p></li>
</ul>
<p>Export the selected features to a new feature class called “inaccessible_salmon_habitat”.</p>
<p>If everything goes <em>swimmingly</em>, then the selected stream segments that meet the habitat criteria and can be reached from the ocean will look something like this:</p>
<p><img src="images/02-selected-streams.png" width="100%" /></p>
<p><strong>For your final report, you will clip these layers to one of the salmon conservation units.</strong></p>
</div>
<div id="final-report" class="section level2 unnumbered hasAnchor">
<h2>Final Report<a href="network-analysis.html#final-report" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For your report, summarize your findings up through the final task. Comment on both small and large scale observations that you made throughout the process. Small scale observations would be investigating the behavior/structure of individual routes, while large scale observations would be the overall differences between total salmon habitat and habitat that can actually be reached from the ocean. Additionally, discuss any limitations to the analysis based on your observations and suggest how the modelling process might be improved further. Illustrate your findings with figures, maps, and tables as needed. You are only expected to comment on a single conservation unit, but you may also run the entire island if you feel ambitious.</p>
<p>Because we introduced so many tools and the lab is already process-intensive, there is no requirement to undertake additional analysis for another scenario. Instead, we are asking you to consider how you might model the other salmon habitat requirements laid out at the beginning of the lab. Give brief examples for how you would model at least three of the criteria that we did not consider in the lab (i.e., do not discuss stream order, stream gradient). Assume that you have access to any typical data source (e.g., LiDAR, optical satellite, RADAR, land inventory, gauge stations, weather stations, etc).</p>
<p>Finally, answer the following questions in your report:</p>
<ul>
<li>Zoom to Lake Cowichan. What is going on here? What could you do to automatically fix this for all large lakes?</li>
<li>How well do the streams you created line up with the mapped streams in the ArcGIS basemap?</li>
<li>How would you expect the stream network to change if you used a raster with a cell size of 5m or 100m?</li>
<li>How might additional topological errors and unidentified/unfilled sinks in the DEM impact your analysis?</li>
</ul>
<hr />
</div>
<div id="summary" class="section level2 unnumbered hasAnchor">
<h2>Summary<a href="network-analysis.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Would you have guessed that you could do all that analysis from a single DEM? That is the power of applying focal functions to the raster (flow direction, flow accumulation, slope) and deriving a network with topology. In this lab, we were principally concerned with events and attributes along the stream segments. Although we did not explicitly calculate connectivity measures, the connectivity of the network was implied through the modelling approach using flow direction from the filled DEM. If you attempted to perform this same analysis without the aid of a DEM, then you would need to take additional precautions to ensure that your polyline features have topological connectivity and valid junctions. Still, our approach using a DEM is prone to artifacts from the raster. Stream segments are limited to eight turning angles and the resolution of the DEM can impact stream attributes.</p>
<p>Return to the <a href="network-analysis.html#lab1-deliverables"><strong>Deliverables</strong></a> section to check off everything you need to submit for credit in the course management system.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lidar-terrain.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
